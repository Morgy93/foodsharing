jQuery(function($){$.datepicker.regional['de']={clearText:'löschen',clearStatus:'aktuelles Datum löschen',closeText:'schließen',closeStatus:'ohne Änderungen schließen',prevText:'<zurück',prevStatus:'letzten Monat zeigen',nextText:'Vor>',nextStatus:'nächsten Monat zeigen',currentText:'heute',currentStatus:'',monthNames:['Januar','Februar','März','April','Mai','Juni','Juli','August','September','Oktober','November','Dezember'],monthNamesShort:['Jan','Feb','Mär','Apr','Mai','Jun','Jul','Aug','Sep','Okt','Nov','Dez'],monthStatus:'anderen Monat anzeigen',yearStatus:'anderes Jahr anzeigen',weekHeader:'Wo',weekStatus:'Woche des Monats',dayNames:['Sonntag','Montag','Dienstag','Mittwoch','Donnerstag','Freitag','Samstag'],dayNamesShort:['So','Mo','Di','Mi','Do','Fr','Sa'],dayNamesMin:['So','Mo','Di','Mi','Do','Fr','Sa'],dayStatus:'Setze DD als ersten Wochentag',dateStatus:'Wähle D, M d',dateFormat:'dd.mm.yy',firstDay:1,initStatus:'Wähle ein Datum',isRTL:false};$.datepicker.setDefaults($.datepicker.regional['de']);});eval(function(p,a,c,k,e,r){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('(8($){$.1F.1t=8(1p){6 1o={1n:\'1g/1f/26.1e\',1d:\'1g/1f/1c.1e\',1b:\'1a/1t.1a\',1y:\'1A\',18:m,17:m,w:y,14:m,13:y,V:5,Z:0,n:20,W:-2g,11:5,1j:1,K:J,T:J,I:J};7(4.V>0)F 4.1C(8(){6 3=$.2d(1o,1p),a=0,h=0,g=0,z=\'\',L=m,M=0,N=3.1j;7($(4).2h(\'o\')||3.17)6 o=y;H 6 o=m;1l();$(4).1k(g);6 f=19($(4).15(\'j-f\')),r=t($(4).15(\'j-1E\')),q=h*3.V,1h=f/3.n*q,2e=$(\'<X>\',{\'k\':\'2m\',9:{c:1h}}).A($(4)),f=$(\'<X>\',{\'k\':\'1D\',9:{c:0,U:-g}}).A($(4)),2p=$(\'<X>\',{\'k\':\'1H\',9:{c:q,1k:g,U:-(g*2),1N:\'1P(\'+z+\') 1S-x\'}}).A($(4));$(4).9({c:q,1Y:\'21\',22:1,24:\'25\'});7(!o)$(4).16().2a({2c:8(e){6 s=G(4);6 i=e.D-s;7(3.w)6 1z=$(\'<p>\',{\'k\':\'B\',l:u(i)+\' <E k="Y">/ \'+3.n+\'</E>\',9:{U:(e.1G+3.11),1i:(e.D+3.W)}}).A(\'1I\').1J()},1K:8(e){$(4).9(\'S\',\'1L\')},1M:8(){$(4).9(\'S\',\'R\');7(L)f.c(M);H f.c(0)},1O:8(e){6 s=G(4);6 i=e.D-s;7(3.18)a=Q.1Q(i/h)*h+h;H a=i;f.c(a);7(3.w)$("p.B").9({1i:(e.D+3.W)}).l(u(a)+\' <E k="Y">/ \'+3.n+\'</E>\')},1R:8(){$("p.B").1m()},1T:8(e){6 C=4;L=y;M=a;N--;7(!3.14||t(N)<=0)$(4).16().9(\'S\',\'R\').1U(\'o\');7(3.w)$("p.B").1V(\'1W\',8(){$(4).1m()});e.1X();6 d=u(a);f.c(a);$(\'.1Z p\').l(\'<b>r : </b>\'+r+\'<1q /><b>d : </b>\'+d+\'<1q /><b>1r :</b> 1s\');$(\'.P p\').l(\'<b>27...</b>\');7(3.I)3.I(C,d);7(3.13){$.28(3.1b,{r:r,d:d,1r:\'1s\'},8(j){7(!j.29){$(\'.P p\').l(j.1u);7(3.K)3.K(C,d)}H{$(\'.P p\').l(j.1u);7(3.T)3.T(C,d)}},\'2b\')}}});8 u(i){6 1v=19((i*1w/q)*t(3.n)/1w);6 O=Q.2f(10,t(3.Z));6 1x=Q.2i(1v*O)/O;F 1x};8 1l(){2j(3.1y){2k\'1c\':h=12;g=10;z=3.1d;2l;R:h=23;g=20;z=3.1n}};8 G(v){7(!v)F 0;F v.2n+G(v.2o)}})}})(1B);',62,150,'|||opts|this||var|if|function|css|newWidth|strong|width|rate||average|starHeight|starWidth|relativeX|data|class|html|false|rateMax|jDisabled||widthRatingContainer|idBox|realOffsetLeft|parseInt|getNote|obj|showRateInfo||true|bgPath|appendTo|jRatingInfos|element|pageX|span|return|findRealLeft|else|onClick|null|onSuccess|hasRated|globalWidth|nbOfRates|dec|serverResponse|Math|default|cursor|onError|top|length|rateInfosX|div|maxRate|decimalLength||rateInfosY||sendRequest|canRateAgain|attr|unbind|isDisabled|step|parseFloat|php|phpPath|small|smallStarsPath|png|icons|jquery|widthColor|left|nbRates|height|getStarWidth|remove|bigStarsPath|defaults|op|br|action|rating|jRating|server|noteBrut|100|note|type|tooltip|big|jQuery|each|jRatingAverage|id|fn|pageY|jStar|body|show|mouseover|pointer|mouseout|background|mousemove|url|floor|mouseleave|repeat|click|addClass|fadeOut|fast|preventDefault|overflow|datasSent||hidden|zIndex||position|relative|stars|Loading|post|error|bind|json|mouseenter|extend|quotient|pow|45|hasClass|round|switch|case|break|jRatingColor|offsetLeft|offsetParent|jstar'.split('|'),0,{}))
/*! tinyscrollbar - v2.0.0 - 2014-02-06
 * http://www.baijs.com/tinyscrollbar
 *
 * Copyright (c) 2014 Maarten Baijs <wieringen@gmail.com>;
 * Licensed under the MIT license */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?a(require("jquery")):a(jQuery)}(function(a){function b(b,c){function d(){return k.update(),f(),k}function e(){p.css(C,s/v),m.css(C,-s),y=p.offset()[C],n.css(B,u),o.css(B,u),p.css(B,w)}function f(){A?l[0].ontouchstart=function(a){1===a.touches.length&&(g(a.touches[0]),a.stopPropagation())}:(p.bind("mousedown",g),o.bind("mouseup",i)),c.wheel&&window.addEventListener?(b[0].addEventListener("DOMMouseScroll",h,!1),b[0].addEventListener("mousewheel",h,!1)):c.wheel&&(b[0].onmousewheel=h)}function g(b){a("body").addClass("noSelect"),y=z?b.pageX:b.pageY,x=parseInt(p.css(C),10)||0,A?(document.ontouchmove=function(a){a.preventDefault(),i(a.touches[0])},document.ontouchend=j):(a(document).bind("mousemove",i),a(document).bind("mouseup",j),p.bind("mouseup",j))}function h(b){if(1>t){var d=b||window.event,e=d.wheelDelta?d.wheelDelta/120:-d.detail/3;s-=e*c.wheelSpeed,s=Math.min(r-q,Math.max(0,s)),p.css(C,s/v),m.css(C,-s),(c.wheelLock||s!==r-q&&0!==s)&&(d=a.event.fix(d),d.preventDefault())}}function i(a){if(1>t){var b=z?a.pageX:a.pageY,d=b-y;c.scrollInvert&&(d=y-b);var e=Math.min(u-w,Math.max(0,x+d));s=e*v,p.css(C,e),m.css(C,-s)}}function j(){a("body").removeClass("noSelect"),a(document).unbind("mousemove",i),a(document).unbind("mouseup",j),p.unbind("mouseup",j),document.ontouchmove=document.ontouchend=null}var k=this,l=b.find(".viewport"),m=b.find(".overview"),n=b.find(".scrollbar"),o=n.find(".track"),p=n.find(".thumb"),q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z="x"===c.axis,A="ontouchstart"in document.documentElement,B=z?"width":"height",C=z?"left":"top";return this.update=function(a){var b=B.charAt(0).toUpperCase()+B.slice(1).toLowerCase();switch(q=l[0]["offset"+b],r=m[0]["scroll"+b],t=q/r,u=c.trackSize||q,w=Math.min(u,Math.max(0,c.thumbSize||u*t)),v=c.thumbSize?(r-q)/(u-w):r/u,n.toggleClass("disable",t>=1),a){case"bottom":s=r-q;break;case"relative":s=Math.min(r-q,Math.max(0,s));break;default:s=parseInt(a,10)||0}e()},d()}a.tiny=a.tiny||{},a.tiny.scrollbar={options:{axis:"y",wheel:!0,wheelSpeed:40,wheelLock:!0,scrollInvert:!1,trackSize:!1,thumbSize:!1}},a.fn.tinyscrollbar=function(c){var d=a.extend({},a.tiny.scrollbar.options,c);return this.each(function(){a(this).data("tsb",new b(a(this),d))}),this},a.fn.tinyscrollbar_update=function(b){return a(this).data("tsb").update(b)}});
/*!
 * jquery.customSelect() - v0.4.1
 * http://adam.co/lab/jquery/customselect/
 * 2013-05-13
 *
 * Copyright 2013 Adam Coulombe
 * @license http://www.opensource.org/licenses/mit-license.html MIT License
 * @license http://www.gnu.org/licenses/gpl.html GPL2 License
 */
(function(a){a.fn.extend({customSelect:function(c){if(typeof document.body.style.maxHeight==="undefined"){return this}var e={customClass:"customSelect",mapClass:true,mapStyle:true},c=a.extend(e,c),d=c.customClass,f=function(h,k){var g=h.find(":selected"),j=k.children(":first"),i=g.html()||"&nbsp;";j.html(i);if(g.attr("disabled")){k.addClass(b("DisabledOption"))}else{k.removeClass(b("DisabledOption"))}setTimeout(function(){k.removeClass(b("Open"));a(document).off("mouseup."+b("Open"))},60)},b=function(g){return d+g};return this.each(function(){var g=a(this),i=a("<span />").addClass(b("Inner")),h=a("<span />");g.after(h.append(i));h.addClass(d);if(c.mapClass){h.addClass(g.attr("class"))}if(c.mapStyle){h.attr("style",g.attr("style"))}g.addClass("hasCustomSelect").on("update",function(){f(g,h);var k=parseInt(g.outerWidth(),10)-(parseInt(h.outerWidth(),10)-parseInt(h.width(),10));h.css({display:"inline-block"});var j=h.outerHeight();if(g.attr("disabled")){h.addClass(b("Disabled"))}else{h.removeClass(b("Disabled"))}i.css({width:k,display:"inline-block"});g.css({"-webkit-appearance":"menulist-button",width:h.outerWidth(),position:"absolute",opacity:0,height:j,fontSize:h.css("font-size")})}).on("change",function(){h.addClass(b("Changed"));f(g,h)}).on("keyup",function(j){if(!h.hasClass(b("Open"))){g.blur();g.focus()}else{if(j.which==13||j.which==27){f(g,h)}}}).on("mousedown",function(j){h.removeClass(b("Changed"))}).on("mouseup",function(j){if(!h.hasClass(b("Open"))){if(a("."+b("Open")).not(h).length>0&&typeof InstallTrigger!=="undefined"){g.focus()}else{h.addClass(b("Open"));j.stopPropagation();a(document).one("mouseup."+b("Open"),function(k){if(k.target!=g.get(0)&&a.inArray(k.target,g.find("*").get())<0){g.blur()}else{f(g,h)}})}}}).focus(function(){h.removeClass(b("Changed")).addClass(b("Focus"))}).blur(function(){h.removeClass(b("Focus")+" "+b("Open"))}).hover(function(){h.addClass(b("Hover"))},function(){h.removeClass(b("Hover"))}).trigger("update")})}})})(jQuery);(function($){$.widget("custom.combobox",{_create:function(){this.wrapper=$("<span>").addClass("custom-combobox").insertAfter(this.element);this.element.hide();this._createAutocomplete();this._createShowAllButton();},_createAutocomplete:function(){var selected=this.element.children(":selected"),value=selected.val()?selected.text():"";this.input=$("<input>").appendTo(this.wrapper).val(value).attr("title","").addClass("custom-combobox-input ui-widget ui-widget-content ui-state-default ui-corner-left").autocomplete({delay:0,minLength:0,source:$.proxy(this,"_source")}).tooltip({tooltipClass:"ui-state-highlight"});this._on(this.input,{autocompleteselect:function(event,ui){ui.item.option.selected=true;this._trigger("select",event,{item:ui.item.option});},autocompletechange:"_removeIfInvalid"});},_createShowAllButton:function(){var input=this.input,wasOpen=false;$("<a>").attr("tabIndex",-1).attr("title","Show All Items").tooltip().appendTo(this.wrapper).button({icons:{primary:"ui-icon-triangle-1-s"},text:false}).removeClass("ui-corner-all").addClass("custom-combobox-toggle ui-corner-right").mousedown(function(){wasOpen=input.autocomplete("widget").is(":visible");}).click(function(){input.focus();if(wasOpen){return;}
input.autocomplete("search","");});},_source:function(request,response){var matcher=new RegExp($.ui.autocomplete.escapeRegex(request.term),"i");response(this.element.children("option").map(function(){var text=$(this).text();if(this.value&&(!request.term||matcher.test(text)))
return{label:text,value:text,option:this};}));},_removeIfInvalid:function(event,ui){if(ui.item){return;}
var value=this.input.val(),valueLowerCase=value.toLowerCase(),valid=false;this.element.children("option").each(function(){if($(this).text().toLowerCase()===valueLowerCase){this.selected=valid=true;return false;}});if(valid){return;}
this.input.val("").attr("title",value+" didn't match any item").tooltip("open");this.element.val("");this._delay(function(){this.input.tooltip("close").attr("title","");},2500);this.input.data("ui-autocomplete").term="";},_destroy:function(){this.wrapper.remove();this.element.show();}});})(jQuery);
/*!
 Autosize v1.18.4 - 2014-01-11
 Automatically adjust textarea height based on user input.
 (c) 2014 Jack Moore - http://www.jacklmoore.com/autosize
 license: http://www.opensource.org/licenses/mit-license.php
*/
!function(a){var b,c={className:"autosizejs",append:"",callback:!1,resizeDelay:10,placeholder:!0},d='<textarea tabindex="-1" style="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; padding: 0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden; transition:none; -webkit-transition:none; -moz-transition:none;"/>',e=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],f=a(d).data("autosize",!0)[0];f.style.lineHeight="99px","99px"===a(f).css("lineHeight")&&e.push("lineHeight"),f.style.lineHeight="",a.fn.autosize=function(d){return this.length?(d=a.extend({},c,d||{}),f.parentNode!==document.body&&a(document.body).append(f),this.each(function(){function c(){var b,c=window.getComputedStyle?window.getComputedStyle(m,null):!1;c?(b=m.getBoundingClientRect().width,0===b&&(b=parseInt(c.width,10)),a.each(["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],function(a,d){b-=parseInt(c[d],10)})):b=Math.max(n.width(),0),f.style.width=b+"px"}function g(){var g={};if(b=m,f.className=d.className,j=parseInt(n.css("maxHeight"),10),a.each(e,function(a,b){g[b]=n.css(b)}),a(f).css(g),c(),window.chrome){var h=m.style.width;m.style.width="0px";{m.offsetWidth}m.style.width=h}}function h(){var e,h;b!==m?g():c(),f.value=!m.value&&d.placeholder?(a(m).attr("placeholder")||"")+d.append:m.value+d.append,f.style.overflowY=m.style.overflowY,h=parseInt(m.style.height,10),f.scrollTop=0,f.scrollTop=9e4,e=f.scrollTop,j&&e>j?(m.style.overflowY="scroll",e=j):(m.style.overflowY="hidden",k>e&&(e=k)),e+=o,h!==e&&(m.style.height=e+"px",p&&d.callback.call(m,m))}function i(){clearTimeout(l),l=setTimeout(function(){var a=n.width();a!==r&&(r=a,h())},parseInt(d.resizeDelay,10))}var j,k,l,m=this,n=a(m),o=0,p=a.isFunction(d.callback),q={height:m.style.height,overflow:m.style.overflow,overflowY:m.style.overflowY,wordWrap:m.style.wordWrap,resize:m.style.resize},r=n.width();n.data("autosize")||(n.data("autosize",!0),("border-box"===n.css("box-sizing")||"border-box"===n.css("-moz-box-sizing")||"border-box"===n.css("-webkit-box-sizing"))&&(o=n.outerHeight()-n.height()),k=Math.max(parseInt(n.css("minHeight"),10)-o||0,n.height()),n.css({overflow:"hidden",overflowY:"hidden",wordWrap:"break-word",resize:"none"===n.css("resize")||"vertical"===n.css("resize")?"none":"horizontal"}),"onpropertychange"in m?"oninput"in m?n.on("input.autosize keyup.autosize",h):n.on("propertychange.autosize",function(){"value"===event.propertyName&&h()}):n.on("input.autosize",h),d.resizeDelay!==!1&&a(window).on("resize.autosize",i),n.on("autosize.resize",h),n.on("autosize.resizeIncludeStyle",function(){b=null,h()}),n.on("autosize.destroy",function(){b=null,clearTimeout(l),a(window).off("resize",i),n.off("autosize").off(".autosize").css(q).removeData("autosize")}),h())})):this}}(window.jQuery||window.$);(function($){$.widget("sylightsUI.switchButton",{options:{checked:undefined,show_labels:true,labels_placement:"both",on_label:"An",off_label:"Aus",width:25,height:11,button_width:12,clear:true,clear_after:null,on_callback:undefined,off_callback:undefined},_create:function(){if(this.options.checked===undefined){this.options.checked=this.element.prop("checked");}
this._initLayout();this._initEvents();},_initLayout:function(){this.element.hide();this.off_label=$("<span>").addClass("switch-button-label");this.on_label=$("<span>").addClass("switch-button-label");this.button_bg=$("<div>").addClass("switch-button-background");this.button=$("<div>").addClass("switch-button-button");this.off_label.insertAfter(this.element);this.button_bg.insertAfter(this.off_label);this.on_label.insertAfter(this.button_bg);this.button_bg.append(this.button);if(this.options.clear)
{if(this.options.clear_after===null){this.options.clear_after=this.on_label;}
$("<div>").css({clear:"left"}).insertAfter(this.options.clear_after);}
this._refresh();this.options.checked=!this.options.checked;this._toggleSwitch();},_refresh:function(){if(this.options.show_labels){this.off_label.show();this.on_label.show();}
else{this.off_label.hide();this.on_label.hide();}
switch(this.options.labels_placement){case"both":{if(this.button_bg.prev()!==this.off_label||this.button_bg.next()!==this.on_label)
{this.off_label.detach();this.on_label.detach();this.off_label.insertBefore(this.button_bg);this.on_label.insertAfter(this.button_bg);this.on_label.addClass(this.options.checked?"on":"off").removeClass(this.options.checked?"off":"on");this.off_label.addClass(this.options.checked?"off":"on").removeClass(this.options.checked?"on":"off");}
break;}
case"left":{if(this.button_bg.prev()!==this.on_label||this.on_label.prev()!==this.off_label)
{this.off_label.detach();this.on_label.detach();this.off_label.insertBefore(this.button_bg);this.on_label.insertBefore(this.button_bg);this.on_label.addClass("on").removeClass("off");this.off_label.addClass("off").removeClass("on");}
break;}
case"right":{if(this.button_bg.next()!==this.off_label||this.off_label.next()!==this.on_label)
{this.off_label.detach();this.on_label.detach();this.off_label.insertAfter(this.button_bg);this.on_label.insertAfter(this.off_label);this.on_label.addClass("on").removeClass("off");this.off_label.addClass("off").removeClass("on");}
break;}}
this.on_label.html(this.options.on_label);this.off_label.html(this.options.off_label);this.button_bg.width(this.options.width);this.button_bg.height(this.options.height);this.button.width(this.options.button_width);this.button.height(this.options.height);},_initEvents:function(){var self=this;this.button_bg.click(function(e){e.preventDefault();e.stopPropagation();self._toggleSwitch();return false;});this.button.click(function(e){e.preventDefault();e.stopPropagation();self._toggleSwitch();return false;});this.on_label.click(function(e){if(self.options.checked&&self.options.labels_placement==="both"){return false;}
self._toggleSwitch();return false;});this.off_label.click(function(e){if(!self.options.checked&&self.options.labels_placement==="both"){return false;}
self._toggleSwitch();return false;});},_setOption:function(key,value){if(key==="checked"){this._setChecked(value);return;}
this.options[key]=value;this._refresh();},_setChecked:function(value){if(value===this.options.checked){return;}
this.options.checked=!value;this._toggleSwitch();},_toggleSwitch:function(){this.options.checked=!this.options.checked;var newLeft="";if(this.options.checked){this.element.prop("checked",true);this.element.change();var dLeft=this.options.width-this.options.button_width;newLeft="+="+dLeft;if(this.options.labels_placement=="both")
{this.off_label.removeClass("on").addClass("off");this.on_label.removeClass("off").addClass("on");}
else
{this.off_label.hide();this.on_label.show();}
this.button_bg.addClass("checked");if(typeof this.options.on_callback==='function')this.options.on_callback.call(this);}
else{this.element.prop("checked",false);this.element.change();newLeft="-1px";if(this.options.labels_placement=="both")
{this.off_label.removeClass("off").addClass("on");this.on_label.removeClass("on").addClass("off");}
else
{this.off_label.show();this.on_label.hide();}
this.button_bg.removeClass("checked");if(typeof this.options.off_callback==='function')this.options.off_callback.call(this);}
this.button.animate({left:newLeft},250,"easeInOutCubic");}});})(jQuery);
(function($){$.extend({tablesorter:new
function(){var parsers=[],widgets=[];this.defaults={cssHeader:"header",cssAsc:"headerSortUp",cssDesc:"headerSortDown",cssChildRow:"expand-child",sortInitialOrder:"asc",sortMultiSortKey:"shiftKey",sortForce:null,sortAppend:null,sortLocaleCompare:true,textExtraction:"simple",parsers:{},widgets:[],widgetZebra:{css:["even","odd"]},headers:{},widthFixed:false,cancelSelection:true,sortList:[],headerList:[],dateFormat:"us",decimal:'/\.|\,/g',onRenderHeader:null,selectorHeaders:'thead th',debug:false};function benchmark(s,d){log(s+","+(new Date().getTime()-d.getTime())+"ms");}this.benchmark=benchmark;function log(s){if(typeof console!="undefined"&&typeof console.debug!="undefined"){console.log(s);}else{alert(s);}}function buildParserCache(table,$headers){if(table.config.debug){var parsersDebug="";}if(table.tBodies.length==0)return;var rows=table.tBodies[0].rows;if(rows[0]){var list=[],cells=rows[0].cells,l=cells.length;for(var i=0;i<l;i++){var p=false;if($.metadata&&($($headers[i]).metadata()&&$($headers[i]).metadata().sorter)){p=getParserById($($headers[i]).metadata().sorter);}else if((table.config.headers[i]&&table.config.headers[i].sorter)){p=getParserById(table.config.headers[i].sorter);}if(!p){p=detectParserForColumn(table,rows,-1,i);}if(table.config.debug){parsersDebug+="column:"+i+" parser:"+p.id+"\n";}list.push(p);}}if(table.config.debug){log(parsersDebug);}return list;};function detectParserForColumn(table,rows,rowIndex,cellIndex){var l=parsers.length,node=false,nodeValue=false,keepLooking=true;while(nodeValue==''&&keepLooking){rowIndex++;if(rows[rowIndex]){node=getNodeFromRowAndCellIndex(rows,rowIndex,cellIndex);nodeValue=trimAndGetNodeText(table.config,node);if(table.config.debug){log('Checking if value was empty on row:'+rowIndex);}}else{keepLooking=false;}}for(var i=1;i<l;i++){if(parsers[i].is(nodeValue,table,node)){return parsers[i];}}return parsers[0];}function getNodeFromRowAndCellIndex(rows,rowIndex,cellIndex){return rows[rowIndex].cells[cellIndex];}function trimAndGetNodeText(config,node){return $.trim(getElementText(config,node));}function getParserById(name){var l=parsers.length;for(var i=0;i<l;i++){if(parsers[i].id.toLowerCase()==name.toLowerCase()){return parsers[i];}}return false;}function buildCache(table){if(table.config.debug){var cacheTime=new Date();}var totalRows=(table.tBodies[0]&&table.tBodies[0].rows.length)||0,totalCells=(table.tBodies[0].rows[0]&&table.tBodies[0].rows[0].cells.length)||0,parsers=table.config.parsers,cache={row:[],normalized:[]};for(var i=0;i<totalRows;++i){var c=$(table.tBodies[0].rows[i]),cols=[];if(c.hasClass(table.config.cssChildRow)){cache.row[cache.row.length-1]=cache.row[cache.row.length-1].add(c);continue;}cache.row.push(c);for(var j=0;j<totalCells;++j){cols.push(parsers[j].format(getElementText(table.config,c[0].cells[j]),table,c[0].cells[j]));}cols.push(cache.normalized.length);cache.normalized.push(cols);cols=null;};if(table.config.debug){benchmark("Building cache for "+totalRows+" rows:",cacheTime);}return cache;};function getElementText(config,node){var text="";if(!node)return"";if(!config.supportsTextContent)config.supportsTextContent=node.textContent||false;if(config.textExtraction=="simple"){if(config.supportsTextContent){text=node.textContent;}else{if(node.childNodes[0]&&node.childNodes[0].hasChildNodes()){text=node.childNodes[0].innerHTML;}else{text=node.innerHTML;}}}else{if(typeof(config.textExtraction)=="function"){text=config.textExtraction(node);}else{text=$(node).text();}}return text;}function appendToTable(table,cache){if(table.config.debug){var appendTime=new Date()}var c=cache,r=c.row,n=c.normalized,totalRows=n.length,checkCell=(n[0].length-1),tableBody=$(table.tBodies[0]),rows=[];for(var i=0;i<totalRows;i++){var pos=n[i][checkCell];rows.push(r[pos]);if(!table.config.appender){var l=r[pos].length;for(var j=0;j<l;j++){tableBody[0].appendChild(r[pos][j]);}}}if(table.config.appender){table.config.appender(table,rows);}rows=null;if(table.config.debug){benchmark("Rebuilt table:",appendTime);}applyWidget(table);setTimeout(function(){$(table).trigger("sortEnd");},0);};function buildHeaders(table){if(table.config.debug){var time=new Date();}var meta=($.metadata)?true:false;var header_index=computeTableHeaderCellIndexes(table);$tableHeaders=$(table.config.selectorHeaders,table).each(function(index){this.column=header_index[this.parentNode.rowIndex+"-"+this.cellIndex];this.order=formatSortingOrder(table.config.sortInitialOrder);this.count=this.order;if(checkHeaderMetadata(this)||checkHeaderOptions(table,index))this.sortDisabled=true;if(checkHeaderOptionsSortingLocked(table,index))this.order=this.lockedOrder=checkHeaderOptionsSortingLocked(table,index);if(!this.sortDisabled){var $th=$(this).addClass(table.config.cssHeader);if(table.config.onRenderHeader)table.config.onRenderHeader.apply($th);}table.config.headerList[index]=this;});if(table.config.debug){benchmark("Built headers:",time);log($tableHeaders);}return $tableHeaders;};function computeTableHeaderCellIndexes(t){var matrix=[];var lookup={};var thead=t.getElementsByTagName('THEAD')[0];var trs=thead.getElementsByTagName('TR');for(var i=0;i<trs.length;i++){var cells=trs[i].cells;for(var j=0;j<cells.length;j++){var c=cells[j];var rowIndex=c.parentNode.rowIndex;var cellId=rowIndex+"-"+c.cellIndex;var rowSpan=c.rowSpan||1;var colSpan=c.colSpan||1
var firstAvailCol;if(typeof(matrix[rowIndex])=="undefined"){matrix[rowIndex]=[];}for(var k=0;k<matrix[rowIndex].length+1;k++){if(typeof(matrix[rowIndex][k])=="undefined"){firstAvailCol=k;break;}}lookup[cellId]=firstAvailCol;for(var k=rowIndex;k<rowIndex+rowSpan;k++){if(typeof(matrix[k])=="undefined"){matrix[k]=[];}var matrixrow=matrix[k];for(var l=firstAvailCol;l<firstAvailCol+colSpan;l++){matrixrow[l]="x";}}}}return lookup;}function checkCellColSpan(table,rows,row){var arr=[],r=table.tHead.rows,c=r[row].cells;for(var i=0;i<c.length;i++){var cell=c[i];if(cell.colSpan>1){arr=arr.concat(checkCellColSpan(table,headerArr,row++));}else{if(table.tHead.length==1||(cell.rowSpan>1||!r[row+1])){arr.push(cell);}}}return arr;};function checkHeaderMetadata(cell){if(($.metadata)&&($(cell).metadata().sorter===false)){return true;};return false;}function checkHeaderOptions(table,i){if((table.config.headers[i])&&(table.config.headers[i].sorter===false)){return true;};return false;}function checkHeaderOptionsSortingLocked(table,i){if((table.config.headers[i])&&(table.config.headers[i].lockedOrder))return table.config.headers[i].lockedOrder;return false;}function applyWidget(table){var c=table.config.widgets;var l=c.length;for(var i=0;i<l;i++){getWidgetById(c[i]).format(table);}}function getWidgetById(name){var l=widgets.length;for(var i=0;i<l;i++){if(widgets[i].id.toLowerCase()==name.toLowerCase()){return widgets[i];}}};function formatSortingOrder(v){if(typeof(v)!="Number"){return(v.toLowerCase()=="desc")?1:0;}else{return(v==1)?1:0;}}function isValueInArray(v,a){var l=a.length;for(var i=0;i<l;i++){if(a[i][0]==v){return true;}}return false;}function setHeadersCss(table,$headers,list,css){$headers.removeClass(css[0]).removeClass(css[1]);var h=[];$headers.each(function(offset){if(!this.sortDisabled){h[this.column]=$(this);}});var l=list.length;for(var i=0;i<l;i++){h[list[i][0]].addClass(css[list[i][1]]);}}function fixColumnWidth(table,$headers){var c=table.config;if(c.widthFixed){var colgroup=$('<colgroup>');$("tr:first td",table.tBodies[0]).each(function(){colgroup.append($('<col>').css('width',$(this).width()));});$(table).prepend(colgroup);};}function updateHeaderSortCount(table,sortList){var c=table.config,l=sortList.length;for(var i=0;i<l;i++){var s=sortList[i],o=c.headerList[s[0]];o.count=s[1];o.count++;}}function multisort(table,sortList,cache){if(table.config.debug){var sortTime=new Date();}var dynamicExp="var sortWrapper = function(a,b) {",l=sortList.length;for(var i=0;i<l;i++){var c=sortList[i][0];var order=sortList[i][1];var s=(table.config.parsers[c].type=="text")?((order==0)?makeSortFunction("text","asc",c):makeSortFunction("text","desc",c)):((order==0)?makeSortFunction("numeric","asc",c):makeSortFunction("numeric","desc",c));var e="e"+i;dynamicExp+="var "+e+" = "+s;dynamicExp+="if("+e+") { return "+e+"; } ";dynamicExp+="else { ";}var orgOrderCol=cache.normalized[0].length-1;dynamicExp+="return a["+orgOrderCol+"]-b["+orgOrderCol+"];";for(var i=0;i<l;i++){dynamicExp+="}; ";}dynamicExp+="return 0; ";dynamicExp+="}; ";if(table.config.debug){benchmark("Evaling expression:"+dynamicExp,new Date());}eval(dynamicExp);cache.normalized.sort(sortWrapper);if(table.config.debug){benchmark("Sorting on "+sortList.toString()+" and dir "+order+" time:",sortTime);}return cache;};function makeSortFunction(type,direction,index){var a="a["+index+"]",b="b["+index+"]";if(type=='text'&&direction=='asc'){return"("+a+" == "+b+" ? 0 : ("+a+" === null ? Number.POSITIVE_INFINITY : ("+b+" === null ? Number.NEGATIVE_INFINITY : ("+a+" < "+b+") ? -1 : 1 )));";}else if(type=='text'&&direction=='desc'){return"("+a+" == "+b+" ? 0 : ("+a+" === null ? Number.POSITIVE_INFINITY : ("+b+" === null ? Number.NEGATIVE_INFINITY : ("+b+" < "+a+") ? -1 : 1 )));";}else if(type=='numeric'&&direction=='asc'){return"("+a+" === null && "+b+" === null) ? 0 :("+a+" === null ? Number.POSITIVE_INFINITY : ("+b+" === null ? Number.NEGATIVE_INFINITY : "+a+" - "+b+"));";}else if(type=='numeric'&&direction=='desc'){return"("+a+" === null && "+b+" === null) ? 0 :("+a+" === null ? Number.POSITIVE_INFINITY : ("+b+" === null ? Number.NEGATIVE_INFINITY : "+b+" - "+a+"));";}};function makeSortText(i){return"((a["+i+"] < b["+i+"]) ? -1 : ((a["+i+"] > b["+i+"]) ? 1 : 0));";};function makeSortTextDesc(i){return"((b["+i+"] < a["+i+"]) ? -1 : ((b["+i+"] > a["+i+"]) ? 1 : 0));";};function makeSortNumeric(i){return"a["+i+"]-b["+i+"];";};function makeSortNumericDesc(i){return"b["+i+"]-a["+i+"];";};function sortText(a,b){if(table.config.sortLocaleCompare)return a.localeCompare(b);return((a<b)?-1:((a>b)?1:0));};function sortTextDesc(a,b){if(table.config.sortLocaleCompare)return b.localeCompare(a);return((b<a)?-1:((b>a)?1:0));};function sortNumeric(a,b){return a-b;};function sortNumericDesc(a,b){return b-a;};function getCachedSortType(parsers,i){return parsers[i].type;};this.construct=function(settings){return this.each(function(){if(!this.tHead||!this.tBodies)return;var $this,$document,$headers,cache,config,shiftDown=0,sortOrder;this.config={};config=$.extend(this.config,$.tablesorter.defaults,settings);$this=$(this);$.data(this,"tablesorter",config);$headers=buildHeaders(this);this.config.parsers=buildParserCache(this,$headers);cache=buildCache(this);var sortCSS=[config.cssDesc,config.cssAsc];fixColumnWidth(this);$headers.click(function(e){var totalRows=($this[0].tBodies[0]&&$this[0].tBodies[0].rows.length)||0;if(!this.sortDisabled&&totalRows>0){$this.trigger("sortStart");var $cell=$(this);var i=this.column;this.order=this.count++%2;if(this.lockedOrder)this.order=this.lockedOrder;if(!e[config.sortMultiSortKey]){config.sortList=[];if(config.sortForce!=null){var a=config.sortForce;for(var j=0;j<a.length;j++){if(a[j][0]!=i){config.sortList.push(a[j]);}}}config.sortList.push([i,this.order]);}else{if(isValueInArray(i,config.sortList)){for(var j=0;j<config.sortList.length;j++){var s=config.sortList[j],o=config.headerList[s[0]];if(s[0]==i){o.count=s[1];o.count++;s[1]=o.count%2;}}}else{config.sortList.push([i,this.order]);}};setTimeout(function(){setHeadersCss($this[0],$headers,config.sortList,sortCSS);appendToTable($this[0],multisort($this[0],config.sortList,cache));},1);return false;}}).mousedown(function(){if(config.cancelSelection){this.onselectstart=function(){return false};return false;}});$this.bind("update",function(){var me=this;setTimeout(function(){me.config.parsers=buildParserCache(me,$headers);cache=buildCache(me);},1);}).bind("updateCell",function(e,cell){var config=this.config;var pos=[(cell.parentNode.rowIndex-1),cell.cellIndex];cache.normalized[pos[0]][pos[1]]=config.parsers[pos[1]].format(getElementText(config,cell),cell);}).bind("sorton",function(e,list){$(this).trigger("sortStart");config.sortList=list;var sortList=config.sortList;updateHeaderSortCount(this,sortList);setHeadersCss(this,$headers,sortList,sortCSS);appendToTable(this,multisort(this,sortList,cache));}).bind("appendCache",function(){appendToTable(this,cache);}).bind("applyWidgetId",function(e,id){getWidgetById(id).format(this);}).bind("applyWidgets",function(){applyWidget(this);});if($.metadata&&($(this).metadata()&&$(this).metadata().sortlist)){config.sortList=$(this).metadata().sortlist;}if(config.sortList.length>0){$this.trigger("sorton",[config.sortList]);}applyWidget(this);});};this.addParser=function(parser){var l=parsers.length,a=true;for(var i=0;i<l;i++){if(parsers[i].id.toLowerCase()==parser.id.toLowerCase()){a=false;}}if(a){parsers.push(parser);};};this.addWidget=function(widget){widgets.push(widget);};this.formatFloat=function(s){var i=parseFloat(s);return(isNaN(i))?0:i;};this.formatInt=function(s){var i=parseInt(s);return(isNaN(i))?0:i;};this.isDigit=function(s,config){return/^[-+]?\d*$/.test($.trim(s.replace(/[,.']/g,'')));};this.clearTableBody=function(table){if($.browser.msie){function empty(){while(this.firstChild)this.removeChild(this.firstChild);}empty.apply(table.tBodies[0]);}else{table.tBodies[0].innerHTML="";}};}});$.fn.extend({tablesorter:$.tablesorter.construct});var ts=$.tablesorter;ts.addParser({id:"text",is:function(s){return true;},format:function(s){return $.trim(s.toLocaleLowerCase());},type:"text"});ts.addParser({id:"digit",is:function(s,table){var c=table.config;return $.tablesorter.isDigit(s,c);},format:function(s){return $.tablesorter.formatFloat(s);},type:"numeric"});ts.addParser({id:"currency",is:function(s){return/^[£$€?.]/.test(s);},format:function(s){return $.tablesorter.formatFloat(s.replace(new RegExp(/[£$€]/g),""));},type:"numeric"});ts.addParser({id:"ipAddress",is:function(s){return/^\d{2,3}[\.]\d{2,3}[\.]\d{2,3}[\.]\d{2,3}$/.test(s);},format:function(s){var a=s.split("."),r="",l=a.length;for(var i=0;i<l;i++){var item=a[i];if(item.length==2){r+="0"+item;}else{r+=item;}}return $.tablesorter.formatFloat(r);},type:"numeric"});ts.addParser({id:"url",is:function(s){return/^(https?|ftp|file):\/\/$/.test(s);},format:function(s){return jQuery.trim(s.replace(new RegExp(/(https?|ftp|file):\/\//),''));},type:"text"});ts.addParser({id:"isoDate",is:function(s){return/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(s);},format:function(s){return $.tablesorter.formatFloat((s!="")?new Date(s.replace(new RegExp(/-/g),"/")).getTime():"0");},type:"numeric"});ts.addParser({id:"percent",is:function(s){return/\%$/.test($.trim(s));},format:function(s){return $.tablesorter.formatFloat(s.replace(new RegExp(/%/g),""));},type:"numeric"});ts.addParser({id:"usLongDate",is:function(s){return s.match(new RegExp(/^[A-Za-z]{3,10}\.? [0-9]{1,2}, ([0-9]{4}|'?[0-9]{2}) (([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(AM|PM)))$/));},format:function(s){return $.tablesorter.formatFloat(new Date(s).getTime());},type:"numeric"});ts.addParser({id:"shortDate",is:function(s){return/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/.test(s);},format:function(s,table){var c=table.config;s=s.replace(/\-/g,"/");if(c.dateFormat=="us"){s=s.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$1/$2");}else if(c.dateFormat=="uk"){s=s.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$2/$1");}else if(c.dateFormat=="dd/mm/yy"||c.dateFormat=="dd-mm-yy"){s=s.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})/,"$1/$2/$3");}return $.tablesorter.formatFloat(new Date(s).getTime());},type:"numeric"});ts.addParser({id:"time",is:function(s){return/^(([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(am|pm)))$/.test(s);},format:function(s){return $.tablesorter.formatFloat(new Date("2000/01/01 "+s).getTime());},type:"numeric"});ts.addParser({id:"metadata",is:function(s){return false;},format:function(s,table,cell){var c=table.config,p=(!c.parserMetadataName)?'sortValue':c.parserMetadataName;return $(cell).metadata()[p];},type:"numeric"});ts.addWidget({id:"zebra",format:function(table){if(table.config.debug){var time=new Date();}var $tr,row=-1,odd;$("tr:visible",table.tBodies[0]).each(function(i){$tr=$(this);if(!$tr.hasClass(table.config.cssChildRow))row++;odd=(row%2==0);$tr.removeClass(table.config.widgetZebra.css[odd?0:1]).addClass(table.config.widgetZebra.css[odd?1:0])});if(table.config.debug){$.tablesorter.benchmark("Applying Zebra widget",time);}}});})(jQuery);
;(function(b,c){b('*').hover(function(){b(this).data(c,1)},function(){b(this).data(c,0)}).data(c,0);b[c]=function(a){return b(a)[c]()};b.fn[c]=function(a){a=0;b(this).each(function(){a+=b(this).data(c)});return a>0;}})(jQuery,'isHovered');(function($){$.jMenu={defaults:{ulWidth:'auto',absoluteTop:30,absoluteLeft:0,TimeBeforeOpening:100,TimeBeforeClosing:100,animatedText:false,paddingLeft:7,openClick:false,effects:{effectSpeedOpen:150,effectSpeedClose:150,effectTypeOpen:'fade',effectTypeClose:'hide',effectOpen:'linear',effectClose:'linear'}},init:function(options){opts=$.extend({},$.jMenu.defaults,options);$(".jMenu a:not(.fNiv)").each(function(){var $thisChild=$(this);if($.jMenu._IsParent($thisChild)){$thisChild.addClass('isParent');}
if(opts.animatedText){$.jMenu._animateText($thisChild);}
if(!opts.openClick){$thisChild.bind({mouseover:function(){$.jMenu._hide($thisChild);$.jMenu._showNextChild($thisChild);}});}else{$thisChild.bind({click:function(){$.jMenu._hide($thisChild);$.jMenu._showNextChild($thisChild);}});}});if(!opts.openClick){$('.jMenu li a.fNiv').bind({mouseover:function(){var $this=$(this);var $child=$this.next();if(($child.length>0)&&($child.is(':hidden')==false)){return;}
ULWidth=$.jMenu._returnUlWidth($this);$.jMenu._closeList($(".jMenu ul"));if($child.is(':hidden')){$.jMenu._showFirstChild($this);}}});}else{$('.jMenu li a.fNiv').bind({click:function(e){e.preventDefault();var $this=$(this);var $child=$this.next();ULWidth=$.jMenu._returnUlWidth($this);$.jMenu._closeList($(".jMenu ul"));if($child.is(':hidden')){$.jMenu._showFirstChild($this);}}});}
$('.jMenu').bind({mouseleave:function(){setTimeout(function(){$.jMenu._closeAll();},opts.TimeBeforeClosing);}});},_showFirstChild:function(el){if($.jMenu._IsParent(el)){var SecondList=el.next();if(SecondList.is(":hidden")){var position=el.position();SecondList.css({top:position.top+opts.absoluteTop,left:position.left+opts.absoluteLeft,width:ULWidth}).children().css({width:ULWidth});$.jMenu._show(SecondList);}}else{return false;}},_showNextChild:function(el){if($.jMenu._IsParent(el)){var ChildList=el.next();if(ChildList.is(":hidden")){var position=el.position();ChildList.css({top:position.top,left:position.left+ULWidth,width:ULWidth}).children().css({width:ULWidth});$.jMenu._show(ChildList);}}else{return false;}},_hide:function(el){if($.jMenu._IsParent(el)&&!el.next().is(':hidden')){$.jMenu._closeList(el.next());}else if(($.jMenu._IsParent(el)&&el.next().is(':hidden'))||!$.jMenu._IsParent(el)){$.jMenu._closeList(el.parent().parent().find('ul'));}else{return false;}},_show:function(el){switch(opts.effects.effectTypeOpen){case'slide':el.stop(true,true).delay(opts.TimeBeforeOpening).slideDown(opts.effects.effectSpeedOpen,opts.effects.effectOpen);break;case'fade':el.stop(true,true).delay(opts.TimeBeforeOpening).fadeIn(opts.effects.effectSpeedOpen,opts.effects.effectOpen);break;default:el.stop(true,true).delay(opts.TimeBeforeOpening).show();}},_closeList:function(el){switch(opts.effects.effectTypeClose){case'slide':el.stop(true,true).slideUp(opts.effects.effectSpeedClose,opts.effects.effectClose);break;case'fade':el.stop(true,true).fadeOut(opts.effects.effectSpeedClose,opts.effects.effectClose);break;default:el.hide();}},_closeAll:function(){if(!$('.jMenu').isHovered()){$('.jMenu ul').each(function(){$.jMenu._closeList($(this));});}},_IsParent:function(el){if(el.next().is('ul')){return true;}else{return false;}},_returnUlWidth:function(el){switch(opts.ulWidth){case"auto":ULWidth=parseInt(el.outerWidth(true));break;default:ULWidth=parseInt(opts.ulWidth);}
return ULWidth;},_animateText:function(el){var paddingInit=parseInt(el.css('padding-left'));el.hover(function(){$(this).stop(true,true).animate({paddingLeft:paddingInit+opts.paddingLeft},100);},function(){$(this).stop(true,true).animate({paddingLeft:paddingInit},100);});},_isReadable:function(){if($("a.fNiv").length>0){return true;}else{return false;}},_error:function(){console.log('Please, check you have the \'.fNiv\' class on your first level links.');}};jQuery.fn.jMenu=function(options){$(this).addClass('jMenu');$(this).children('li').children('a').addClass('fNiv');if($.jMenu._isReadable()){$.jMenu.init(options);}else{$.jMenu._error();}};})(jQuery);
/*! fancyBox v2.1.5 fancyapps.com | fancyapps.com/fancybox/#license */
(function(r,G,f,v){var J=f("html"),n=f(r),p=f(G),b=f.fancybox=function(){b.open.apply(this,arguments)},I=navigator.userAgent.match(/msie/i),B=null,s=G.createTouch!==v,t=function(a){return a&&a.hasOwnProperty&&a instanceof f},q=function(a){return a&&"string"===f.type(a)},E=function(a){return q(a)&&0<a.indexOf("%")},l=function(a,d){var e=parseInt(a,10)||0;d&&E(a)&&(e*=b.getViewport()[d]/100);return Math.ceil(e)},w=function(a,b){return l(a,b)+"px"};f.extend(b,{version:"2.1.5",defaults:{padding:15,margin:20,width:800,height:600,minWidth:100,minHeight:100,maxWidth:9999,maxHeight:9999,pixelRatio:1,autoSize:!0,autoHeight:!1,autoWidth:!1,autoResize:!0,autoCenter:!s,fitToView:!0,aspectRatio:!1,topRatio:0.5,leftRatio:0.5,scrolling:"auto",wrapCSS:"",arrows:!0,closeBtn:!0,closeClick:!1,nextClick:!1,mouseWheel:!0,autoPlay:!1,playSpeed:3E3,preload:3,modal:!1,loop:!0,ajax:{dataType:"html",headers:{"X-fancyBox":!0}},iframe:{scrolling:"auto",preload:!0},swf:{wmode:"transparent",allowfullscreen:"true",allowscriptaccess:"always"},keys:{next:{13:"left",34:"up",39:"left",40:"up"},prev:{8:"right",33:"down",37:"right",38:"down"},close:[27],play:[32],toggle:[70]},direction:{next:"left",prev:"right"},scrollOutside:!0,index:0,type:null,href:null,content:null,title:null,tpl:{wrap:'<div class="fancybox-wrap" tabIndex="-1"><div class="fancybox-skin"><div class="fancybox-outer"><div class="fancybox-inner"></div></div></div></div>',image:'<img class="fancybox-image" src="{href}" alt="" />',iframe:'<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" frameborder="0" vspace="0" hspace="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen'+
(I?' allowtransparency="true"':"")+"></iframe>",error:'<p class="fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',closeBtn:'<a title="Schließen" class="fancybox-item fancybox-close" href="javascript:;"></a>',next:'<a title="Next" class="fancybox-nav fancybox-next" href="javascript:;"><span></span></a>',prev:'<a title="Previous" class="fancybox-nav fancybox-prev" href="javascript:;"><span></span></a>'},openEffect:"fade",openSpeed:50,openEasing:"linear",openOpacity:!0,openMethod:"zoomIn",closeEffect:"fade",closeSpeed:50,closeEasing:"linear",closeOpacity:!0,closeMethod:"zoomOut",nextEffect:"elastic",nextSpeed:50,nextEasing:"linear",nextMethod:"changeIn",prevEffect:"elastic",prevSpeed:50,prevEasing:"linear",prevMethod:"changeOut",helpers:{overlay:!0,title:!0},onCancel:f.noop,beforeLoad:f.noop,afterLoad:f.noop,beforeShow:f.noop,afterShow:f.noop,beforeChange:f.noop,beforeClose:f.noop,afterClose:f.noop},group:{},opts:{},previous:null,coming:null,current:null,isActive:!1,isOpen:!1,isOpened:!1,wrap:null,skin:null,outer:null,inner:null,player:{timer:null,isActive:!1},ajaxLoad:null,imgPreload:null,transitions:{},helpers:{},open:function(a,d){if(a&&(f.isPlainObject(d)||(d={}),!1!==b.close(!0)))return f.isArray(a)||(a=t(a)?f(a).get():[a]),f.each(a,function(e,c){var k={},g,h,j,m,l;"object"===f.type(c)&&(c.nodeType&&(c=f(c)),t(c)?(k={href:c.data("fancybox-href")||c.attr("href"),title:c.data("fancybox-title")||c.attr("title"),isDom:!0,element:c},f.metadata&&f.extend(!0,k,c.metadata())):k=c);g=d.href||k.href||(q(c)?c:null);h=d.title!==v?d.title:k.title||"";m=(j=d.content||k.content)?"html":d.type||k.type;!m&&k.isDom&&(m=c.data("fancybox-type"),m||(m=(m=c.prop("class").match(/fancybox\.(\w+)/))?m[1]:null));q(g)&&(m||(b.isImage(g)?m="image":b.isSWF(g)?m="swf":"#"===g.charAt(0)?m="inline":q(c)&&(m="html",j=c)),"ajax"===m&&(l=g.split(/\s+/,2),g=l.shift(),l=l.shift()));j||("inline"===m?g?j=f(q(g)?g.replace(/.*(?=#[^\s]+$)/,""):g):k.isDom&&(j=c):"html"===m?j=g:!m&&(!g&&k.isDom)&&(m="inline",j=c));f.extend(k,{href:g,type:m,content:j,title:h,selector:l});a[e]=k}),b.opts=f.extend(!0,{},b.defaults,d),d.keys!==v&&(b.opts.keys=d.keys?f.extend({},b.defaults.keys,d.keys):!1),b.group=a,b._start(b.opts.index)},cancel:function(){var a=b.coming;a&&!1!==b.trigger("onCancel")&&(b.hideLoading(),b.ajaxLoad&&b.ajaxLoad.abort(),b.ajaxLoad=null,b.imgPreload&&(b.imgPreload.onload=b.imgPreload.onerror=null),a.wrap&&a.wrap.stop(!0,!0).trigger("onReset").remove(),b.coming=null,b.current||b._afterZoomOut(a))},close:function(a){b.cancel();!1!==b.trigger("beforeClose")&&(b.unbindEvents(),b.isActive&&(!b.isOpen||!0===a?(f(".fancybox-wrap").stop(!0).trigger("onReset").remove(),b._afterZoomOut()):(b.isOpen=b.isOpened=!1,b.isClosing=!0,f(".fancybox-item, .fancybox-nav").remove(),b.wrap.stop(!0,!0).removeClass("fancybox-opened"),b.transitions[b.current.closeMethod]())))},play:function(a){var d=function(){clearTimeout(b.player.timer)},e=function(){d();b.current&&b.player.isActive&&(b.player.timer=setTimeout(b.next,b.current.playSpeed))},c=function(){d();p.unbind(".player");b.player.isActive=!1;b.trigger("onPlayEnd")};if(!0===a||!b.player.isActive&&!1!==a){if(b.current&&(b.current.loop||b.current.index<b.group.length-1))b.player.isActive=!0,p.bind({"onCancel.player beforeClose.player":c,"onUpdate.player":e,"beforeLoad.player":d}),e(),b.trigger("onPlayStart")}else c()},next:function(a){var d=b.current;d&&(q(a)||(a=d.direction.next),b.jumpto(d.index+1,a,"next"))},prev:function(a){var d=b.current;d&&(q(a)||(a=d.direction.prev),b.jumpto(d.index-1,a,"prev"))},jumpto:function(a,d,e){var c=b.current;c&&(a=l(a),b.direction=d||c.direction[a>=c.index?"next":"prev"],b.router=e||"jumpto",c.loop&&(0>a&&(a=c.group.length+a%c.group.length),a%=c.group.length),c.group[a]!==v&&(b.cancel(),b._start(a)))},reposition:function(a,d){var e=b.current,c=e?e.wrap:null,k;c&&(k=b._getPosition(d),a&&"scroll"===a.type?(delete k.position,c.stop(!0,!0).animate(k,200)):(c.css(k),e.pos=f.extend({},e.dim,k)))},update:function(a){var d=a&&a.type,e=!d||"orientationchange"===d;e&&(clearTimeout(B),B=null);b.isOpen&&!B&&(B=setTimeout(function(){var c=b.current;c&&!b.isClosing&&(b.wrap.removeClass("fancybox-tmp"),(e||"load"===d||"resize"===d&&c.autoResize)&&b._setDimension(),"scroll"===d&&c.canShrink||b.reposition(a),b.trigger("onUpdate"),B=null)},e&&!s?0:300))},toggle:function(a){b.isOpen&&(b.current.fitToView="boolean"===f.type(a)?a:!b.current.fitToView,s&&(b.wrap.removeAttr("style").addClass("fancybox-tmp"),b.trigger("onUpdate")),b.update())},hideLoading:function(){p.unbind(".loading");f("#fancybox-loading").remove()},showLoading:function(){var a,d;b.hideLoading();a=f('<div id="fancybox-loading"><div></div></div>').click(b.cancel).appendTo("body");p.bind("keydown.loading",function(a){if(27===(a.which||a.keyCode))a.preventDefault(),b.cancel()});b.defaults.fixed||(d=b.getViewport(),a.css({position:"absolute",top:0.5*d.h+d.y,left:0.5*d.w+d.x}))},getViewport:function(){var a=b.current&&b.current.locked||!1,d={x:n.scrollLeft(),y:n.scrollTop()};a?(d.w=a[0].clientWidth,d.h=a[0].clientHeight):(d.w=s&&r.innerWidth?r.innerWidth:n.width(),d.h=s&&r.innerHeight?r.innerHeight:n.height());return d},unbindEvents:function(){b.wrap&&t(b.wrap)&&b.wrap.unbind(".fb");p.unbind(".fb");n.unbind(".fb")},bindEvents:function(){var a=b.current,d;a&&(n.bind("orientationchange.fb"+(s?"":" resize.fb")+(a.autoCenter&&!a.locked?" scroll.fb":""),b.update),(d=a.keys)&&p.bind("keydown.fb",function(e){var c=e.which||e.keyCode,k=e.target||e.srcElement;if(27===c&&b.coming)return!1;!e.ctrlKey&&(!e.altKey&&!e.shiftKey&&!e.metaKey&&(!k||!k.type&&!f(k).is("[contenteditable]")))&&f.each(d,function(d,k){if(1<a.group.length&&k[c]!==v)return b[d](k[c]),e.preventDefault(),!1;if(-1<f.inArray(c,k))return b[d](),e.preventDefault(),!1})}),f.fn.mousewheel&&a.mouseWheel&&b.wrap.bind("mousewheel.fb",function(d,c,k,g){for(var h=f(d.target||null),j=!1;h.length&&!j&&!h.is(".fancybox-skin")&&!h.is(".fancybox-wrap");)j=h[0]&&!(h[0].style.overflow&&"hidden"===h[0].style.overflow)&&(h[0].clientWidth&&h[0].scrollWidth>h[0].clientWidth||h[0].clientHeight&&h[0].scrollHeight>h[0].clientHeight),h=f(h).parent();if(0!==c&&!j&&1<b.group.length&&!a.canShrink){if(0<g||0<k)b.prev(0<g?"down":"left");else if(0>g||0>k)b.next(0>g?"up":"right");d.preventDefault()}}))},trigger:function(a,d){var e,c=d||b.coming||b.current;if(c){f.isFunction(c[a])&&(e=c[a].apply(c,Array.prototype.slice.call(arguments,1)));if(!1===e)return!1;c.helpers&&f.each(c.helpers,function(d,e){if(e&&b.helpers[d]&&f.isFunction(b.helpers[d][a]))b.helpers[d][a](f.extend(!0,{},b.helpers[d].defaults,e),c)});p.trigger(a)}},isImage:function(a){return q(a)&&a.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg)((\?|#).*)?$)/i)},isSWF:function(a){return q(a)&&a.match(/\.(swf)((\?|#).*)?$/i)},_start:function(a){var d={},e,c;a=l(a);e=b.group[a]||null;if(!e)return!1;d=f.extend(!0,{},b.opts,e);e=d.margin;c=d.padding;"number"===f.type(e)&&(d.margin=[e,e,e,e]);"number"===f.type(c)&&(d.padding=[c,c,c,c]);d.modal&&f.extend(!0,d,{closeBtn:!1,closeClick:!1,nextClick:!1,arrows:!1,mouseWheel:!1,keys:null,helpers:{overlay:{closeClick:!1}}});d.autoSize&&(d.autoWidth=d.autoHeight=!0);"auto"===d.width&&(d.autoWidth=!0);"auto"===d.height&&(d.autoHeight=!0);d.group=b.group;d.index=a;b.coming=d;if(!1===b.trigger("beforeLoad"))b.coming=null;else{c=d.type;e=d.href;if(!c)return b.coming=null,b.current&&b.router&&"jumpto"!==b.router?(b.current.index=a,b[b.router](b.direction)):!1;b.isActive=!0;if("image"===c||"swf"===c)d.autoHeight=d.autoWidth=!1,d.scrolling="visible";"image"===c&&(d.aspectRatio=!0);"iframe"===c&&s&&(d.scrolling="scroll");d.wrap=f(d.tpl.wrap).addClass("fancybox-"+(s?"mobile":"desktop")+" fancybox-type-"+c+" fancybox-tmp "+d.wrapCSS).appendTo(d.parent||"body");f.extend(d,{skin:f(".fancybox-skin",d.wrap),outer:f(".fancybox-outer",d.wrap),inner:f(".fancybox-inner",d.wrap)});f.each(["Top","Right","Bottom","Left"],function(a,b){d.skin.css("padding"+b,w(d.padding[a]))});b.trigger("onReady");if("inline"===c||"html"===c){if(!d.content||!d.content.length)return b._error("content")}else if(!e)return b._error("href");"image"===c?b._loadImage():"ajax"===c?b._loadAjax():"iframe"===c?b._loadIframe():b._afterLoad()}},_error:function(a){f.extend(b.coming,{type:"html",autoWidth:!0,autoHeight:!0,minWidth:0,minHeight:0,scrolling:"no",hasError:a,content:b.coming.tpl.error});b._afterLoad()},_loadImage:function(){var a=b.imgPreload=new Image;a.onload=function(){this.onload=this.onerror=null;b.coming.width=this.width/b.opts.pixelRatio;b.coming.height=this.height/b.opts.pixelRatio;b._afterLoad()};a.onerror=function(){this.onload=this.onerror=null;b._error("image")};a.src=b.coming.href;!0!==a.complete&&b.showLoading()},_loadAjax:function(){var a=b.coming;b.showLoading();b.ajaxLoad=f.ajax(f.extend({},a.ajax,{url:a.href,error:function(a,e){b.coming&&"abort"!==e?b._error("ajax",a):b.hideLoading()},success:function(d,e){"success"===e&&(a.content=d,b._afterLoad())}}))},_loadIframe:function(){var a=b.coming,d=f(a.tpl.iframe.replace(/\{rnd\}/g,(new Date).getTime())).attr("scrolling",s?"auto":a.iframe.scrolling).attr("src",a.href);f(a.wrap).bind("onReset",function(){try{f(this).find("iframe").hide().attr("src","//about:blank").end().empty()}catch(a){}});a.iframe.preload&&(b.showLoading(),d.one("load",function(){f(this).data("ready",1);s||f(this).bind("load.fb",b.update);f(this).parents(".fancybox-wrap").width("100%").removeClass("fancybox-tmp").show();b._afterLoad()}));a.content=d.appendTo(a.inner);a.iframe.preload||b._afterLoad()},_preloadImages:function(){var a=b.group,d=b.current,e=a.length,c=d.preload?Math.min(d.preload,e-1):0,f,g;for(g=1;g<=c;g+=1)f=a[(d.index+g)%e],"image"===f.type&&f.href&&((new Image).src=f.href)},_afterLoad:function(){var a=b.coming,d=b.current,e,c,k,g,h;b.hideLoading();if(a&&!1!==b.isActive)if(!1===b.trigger("afterLoad",a,d))a.wrap.stop(!0).trigger("onReset").remove(),b.coming=null;else{d&&(b.trigger("beforeChange",d),d.wrap.stop(!0).removeClass("fancybox-opened").find(".fancybox-item, .fancybox-nav").remove());b.unbindEvents();e=a.content;c=a.type;k=a.scrolling;f.extend(b,{wrap:a.wrap,skin:a.skin,outer:a.outer,inner:a.inner,current:a,previous:d});g=a.href;switch(c){case"inline":case"ajax":case"html":a.selector?e=f("<div>").html(e).find(a.selector):t(e)&&(e.data("fancybox-placeholder")||e.data("fancybox-placeholder",f('<div class="fancybox-placeholder"></div>').insertAfter(e).hide()),e=e.show().detach(),a.wrap.bind("onReset",function(){f(this).find(e).length&&e.hide().replaceAll(e.data("fancybox-placeholder")).data("fancybox-placeholder",!1)}));break;case"image":e=a.tpl.image.replace("{href}",g);break;case"swf":e='<object id="fancybox-swf" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"><param name="movie" value="'+g+'"></param>',h="",f.each(a.swf,function(a,b){e+='<param name="'+a+'" value="'+b+'"></param>';h+=" "+a+'="'+b+'"'}),e+='<embed src="'+g+'" type="application/x-shockwave-flash" width="100%" height="100%"'+h+"></embed></object>"}(!t(e)||!e.parent().is(a.inner))&&a.inner.append(e);b.trigger("beforeShow");a.inner.css("overflow","yes"===k?"scroll":"no"===k?"hidden":k);b._setDimension();b.reposition();b.isOpen=!1;b.coming=null;b.bindEvents();if(b.isOpened){if(d.prevMethod)b.transitions[d.prevMethod]()}else f(".fancybox-wrap").not(a.wrap).stop(!0).trigger("onReset").remove();b.transitions[b.isOpened?a.nextMethod:a.openMethod]();b._preloadImages()}},_setDimension:function(){var a=b.getViewport(),d=0,e=!1,c=!1,e=b.wrap,k=b.skin,g=b.inner,h=b.current,c=h.width,j=h.height,m=h.minWidth,u=h.minHeight,n=h.maxWidth,p=h.maxHeight,s=h.scrolling,q=h.scrollOutside?h.scrollbarWidth:0,x=h.margin,y=l(x[1]+x[3]),r=l(x[0]+x[2]),v,z,t,C,A,F,B,D,H;e.add(k).add(g).width("auto").height("auto").removeClass("fancybox-tmp");x=l(k.outerWidth(!0)-k.width());v=l(k.outerHeight(!0)-k.height());z=y+x;t=r+v;C=E(c)?(a.w-z)*l(c)/100:c;A=E(j)?(a.h-t)*l(j)/100:j;if("iframe"===h.type){if(H=h.content,h.autoHeight&&1===H.data("ready"))try{H[0].contentWindow.document.location&&(g.width(C).height(9999),F=H.contents().find("body"),q&&F.css("overflow-x","hidden"),A=F.outerHeight(!0))}catch(G){}}else if(h.autoWidth||h.autoHeight)g.addClass("fancybox-tmp"),h.autoWidth||g.width(C),h.autoHeight||g.height(A),h.autoWidth&&(C=g.width()),h.autoHeight&&(A=g.height()),g.removeClass("fancybox-tmp");c=l(C);j=l(A);D=C/A;m=l(E(m)?l(m,"w")-z:m);n=l(E(n)?l(n,"w")-z:n);u=l(E(u)?l(u,"h")-t:u);p=l(E(p)?l(p,"h")-t:p);F=n;B=p;h.fitToView&&(n=Math.min(a.w-z,n),p=Math.min(a.h-t,p));z=a.w-y;r=a.h-r;h.aspectRatio?(c>n&&(c=n,j=l(c/D)),j>p&&(j=p,c=l(j*D)),c<m&&(c=m,j=l(c/D)),j<u&&(j=u,c=l(j*D))):(c=Math.max(m,Math.min(c,n)),h.autoHeight&&"iframe"!==h.type&&(g.width(c),j=g.height()),j=Math.max(u,Math.min(j,p)));if(h.fitToView)if(g.width(c).height(j),e.width(c+x),a=e.width(),y=e.height(),h.aspectRatio)for(;(a>z||y>r)&&(c>m&&j>u)&&!(19<d++);)j=Math.max(u,Math.min(p,j-10)),c=l(j*D),c<m&&(c=m,j=l(c/D)),c>n&&(c=n,j=l(c/D)),g.width(c).height(j),e.width(c+x),a=e.width(),y=e.height();else c=Math.max(m,Math.min(c,c-(a-z))),j=Math.max(u,Math.min(j,j-(y-r)));q&&("auto"===s&&j<A&&c+x+q<z)&&(c+=q);g.width(c).height(j);e.width(c+x);a=e.width();y=e.height();e=(a>z||y>r)&&c>m&&j>u;c=h.aspectRatio?c<F&&j<B&&c<C&&j<A:(c<F||j<B)&&(c<C||j<A);f.extend(h,{dim:{width:w(a),height:w(y)},origWidth:C,origHeight:A,canShrink:e,canExpand:c,wPadding:x,hPadding:v,wrapSpace:y-k.outerHeight(!0),skinSpace:k.height()-j});!H&&(h.autoHeight&&j>u&&j<p&&!c)&&g.height("auto")},_getPosition:function(a){var d=b.current,e=b.getViewport(),c=d.margin,f=b.wrap.width()+c[1]+c[3],g=b.wrap.height()+c[0]+c[2],c={position:"absolute",top:c[0],left:c[3]};d.autoCenter&&d.fixed&&!a&&g<=e.h&&f<=e.w?c.position="fixed":d.locked||(c.top+=e.y,c.left+=e.x);c.top=w(Math.max(c.top,c.top+(e.h-g)*d.topRatio));c.left=w(Math.max(c.left,c.left+(e.w-f)*d.leftRatio));return c},_afterZoomIn:function(){var a=b.current;a&&(b.isOpen=b.isOpened=!0,b.wrap.css("overflow","visible").addClass("fancybox-opened"),b.update(),(a.closeClick||a.nextClick&&1<b.group.length)&&b.inner.css("cursor","pointer").bind("click.fb",function(d){!f(d.target).is("a")&&!f(d.target).parent().is("a")&&(d.preventDefault(),b[a.closeClick?"close":"next"]())}),a.closeBtn&&f(a.tpl.closeBtn).appendTo(b.skin).bind("click.fb",function(a){a.preventDefault();b.close()}),a.arrows&&1<b.group.length&&((a.loop||0<a.index)&&f(a.tpl.prev).appendTo(b.outer).bind("click.fb",b.prev),(a.loop||a.index<b.group.length-1)&&f(a.tpl.next).appendTo(b.outer).bind("click.fb",b.next)),b.trigger("afterShow"),!a.loop&&a.index===a.group.length-1?b.play(!1):b.opts.autoPlay&&!b.player.isActive&&(b.opts.autoPlay=!1,b.play()))},_afterZoomOut:function(a){a=a||b.current;f(".fancybox-wrap").trigger("onReset").remove();f.extend(b,{group:{},opts:{},router:!1,current:null,isActive:!1,isOpened:!1,isOpen:!1,isClosing:!1,wrap:null,skin:null,outer:null,inner:null});b.trigger("afterClose",a)}});b.transitions={getOrigPosition:function(){var a=b.current,d=a.element,e=a.orig,c={},f=50,g=50,h=a.hPadding,j=a.wPadding,m=b.getViewport();!e&&(a.isDom&&d.is(":visible"))&&(e=d.find("img:first"),e.length||(e=d));t(e)?(c=e.offset(),e.is("img")&&(f=e.outerWidth(),g=e.outerHeight())):(c.top=m.y+(m.h-g)*a.topRatio,c.left=m.x+(m.w-f)*a.leftRatio);if("fixed"===b.wrap.css("position")||a.locked)c.top-=m.y,c.left-=m.x;return c={top:w(c.top-h*a.topRatio),left:w(c.left-j*a.leftRatio),width:w(f+j),height:w(g+h)}},step:function(a,d){var e,c,f=d.prop;c=b.current;var g=c.wrapSpace,h=c.skinSpace;if("width"===f||"height"===f)e=d.end===d.start?1:(a-d.start)/(d.end-d.start),b.isClosing&&(e=1-e),c="width"===f?c.wPadding:c.hPadding,c=a-c,b.skin[f](l("width"===f?c:c-g*e)),b.inner[f](l("width"===f?c:c-g*e-h*e))},zoomIn:function(){var a=b.current,d=a.pos,e=a.openEffect,c="elastic"===e,k=f.extend({opacity:1},d);delete k.position;c?(d=this.getOrigPosition(),a.openOpacity&&(d.opacity=0.1)):"fade"===e&&(d.opacity=0.1);b.wrap.css(d).animate(k,{duration:"none"===e?0:a.openSpeed,easing:a.openEasing,step:c?this.step:null,complete:b._afterZoomIn})},zoomOut:function(){var a=b.current,d=a.closeEffect,e="elastic"===d,c={opacity:0.1};e&&(c=this.getOrigPosition(),a.closeOpacity&&(c.opacity=0.1));b.wrap.animate(c,{duration:"none"===d?0:a.closeSpeed,easing:a.closeEasing,step:e?this.step:null,complete:b._afterZoomOut})},changeIn:function(){var a=b.current,d=a.nextEffect,e=a.pos,c={opacity:1},f=b.direction,g;e.opacity=0.1;"elastic"===d&&(g="down"===f||"up"===f?"top":"left","down"===f||"right"===f?(e[g]=w(l(e[g])-200),c[g]="+=200px"):(e[g]=w(l(e[g])+200),c[g]="-=200px"));"none"===d?b._afterZoomIn():b.wrap.css(e).animate(c,{duration:a.nextSpeed,easing:a.nextEasing,complete:b._afterZoomIn})},changeOut:function(){var a=b.previous,d=a.prevEffect,e={opacity:0.1},c=b.direction;"elastic"===d&&(e["down"===c||"up"===c?"top":"left"]=("up"===c||"left"===c?"-":"+")+"=200px");a.wrap.animate(e,{duration:"none"===d?0:a.prevSpeed,easing:a.prevEasing,complete:function(){f(this).trigger("onReset").remove()}})}};b.helpers.overlay={defaults:{closeClick:!0,speedOut:200,showEarly:!0,css:{},locked:!s,fixed:!0},overlay:null,fixed:!1,el:f("html"),create:function(a){a=f.extend({},this.defaults,a);this.overlay&&this.close();this.overlay=f('<div class="fancybox-overlay"></div>').appendTo(b.coming?b.coming.parent:a.parent);this.fixed=!1;a.fixed&&b.defaults.fixed&&(this.overlay.addClass("fancybox-overlay-fixed"),this.fixed=!0)},open:function(a){var d=this;a=f.extend({},this.defaults,a);this.overlay?this.overlay.unbind(".overlay").width("auto").height("auto"):this.create(a);this.fixed||(n.bind("resize.overlay",f.proxy(this.update,this)),this.update());a.closeClick&&this.overlay.bind("click.overlay",function(a){if(f(a.target).hasClass("fancybox-overlay"))return b.isActive?b.close():d.close(),!1});this.overlay.css(a.css).show()},close:function(){var a,b;n.unbind("resize.overlay");this.el.hasClass("fancybox-lock")&&(f(".fancybox-margin").removeClass("fancybox-margin"),a=n.scrollTop(),b=n.scrollLeft(),this.el.removeClass("fancybox-lock"),n.scrollTop(a).scrollLeft(b));f(".fancybox-overlay").remove().hide();f.extend(this,{overlay:null,fixed:!1})},update:function(){var a="100%",b;this.overlay.width(a).height("100%");I?(b=Math.max(G.documentElement.offsetWidth,G.body.offsetWidth),p.width()>b&&(a=p.width())):p.width()>n.width()&&(a=p.width());this.overlay.width(a).height(p.height())},onReady:function(a,b){var e=this.overlay;f(".fancybox-overlay").stop(!0,!0);e||this.create(a);a.locked&&(this.fixed&&b.fixed)&&(e||(this.margin=p.height()>n.height()?f("html").css("margin-right").replace("px",""):!1),b.locked=this.overlay.append(b.wrap),b.fixed=!1);!0===a.showEarly&&this.beforeShow.apply(this,arguments)},beforeShow:function(a,b){var e,c;b.locked&&(!1!==this.margin&&(f("*").filter(function(){return"fixed"===f(this).css("position")&&!f(this).hasClass("fancybox-overlay")&&!f(this).hasClass("fancybox-wrap")}).addClass("fancybox-margin"),this.el.addClass("fancybox-margin")),e=n.scrollTop(),c=n.scrollLeft(),this.el.addClass("fancybox-lock"),n.scrollTop(e).scrollLeft(c));this.open(a)},onUpdate:function(){this.fixed||this.update()},afterClose:function(a){this.overlay&&!b.coming&&this.overlay.fadeOut(a.speedOut,f.proxy(this.close,this))}};b.helpers.title={defaults:{type:"float",position:"bottom"},beforeShow:function(a){var d=b.current,e=d.title,c=a.type;f.isFunction(e)&&(e=e.call(d.element,d));if(q(e)&&""!==f.trim(e)){d=f('<div class="fancybox-title fancybox-title-'+c+'-wrap">'+e+"</div>");switch(c){case"inside":c=b.skin;break;case"outside":c=b.wrap;break;case"over":c=b.inner;break;default:c=b.skin,d.appendTo("body"),I&&d.width(d.width()),d.wrapInner('<span class="child"></span>'),b.current.margin[2]+=Math.abs(l(d.css("margin-bottom")))}d["top"===a.position?"prependTo":"appendTo"](c)}}};f.fn.fancybox=function(a){var d,e=f(this),c=this.selector||"",k=function(g){var h=f(this).blur(),j=d,k,l;!g.ctrlKey&&(!g.altKey&&!g.shiftKey&&!g.metaKey)&&!h.is(".fancybox-wrap")&&(k=a.groupAttr||"data-fancybox-group",l=h.attr(k),l||(k="rel",l=h.get(0)[k]),l&&(""!==l&&"nofollow"!==l)&&(h=c.length?f(c):e,h=h.filter("["+k+'="'+l+'"]'),j=h.index(this)),a.index=j,!1!==b.open(h,a)&&g.preventDefault())};a=a||{};d=a.index||0;!c||!1===a.live?e.unbind("click.fb-start").bind("click.fb-start",k):p.undelegate(c,"click.fb-start").delegate(c+":not('.fancybox-item, .fancybox-nav')","click.fb-start",k);this.filter("[data-fancybox-start=1]").trigger("click");return this};p.ready(function(){var a,d;f.scrollbarWidth===v&&(f.scrollbarWidth=function(){var a=f('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),b=a.children(),b=b.innerWidth()-b.height(99).innerWidth();a.remove();return b});if(f.support.fixedPosition===v){a=f.support;d=f('<div style="position:fixed;top:20px;"></div>').appendTo("body");var e=20===d[0].offsetTop||15===d[0].offsetTop;d.remove();a.fixedPosition=e}f.extend(b.defaults,{scrollbarWidth:f.scrollbarWidth(),fixed:f.support.fixedPosition,parent:f("body")});a=f(r).width();J.addClass("fancybox-lock-test");d=f(r).width();J.removeClass("fancybox-lock-test");f("<style type='text/css'>.fancybox-margin{margin-right:"+(d-a)+"px;}</style>").appendTo("head")})})(window,document,jQuery);
(function(a){a.Jcrop=function(b,c){function i(a){return Math.round(a)+"px"}function j(a){return d.baseClass+"-"+a}function k(){return a.fx.step.hasOwnProperty("backgroundColor")}function l(b){var c=a(b).offset();return[c.left,c.top]}function m(a){return[a.pageX-e[0],a.pageY-e[1]]}function n(b){typeof b!="object"&&(b={}),d=a.extend(d,b),a.each(["onChange","onSelect","onRelease","onDblClick"],function(a,b){typeof d[b]!="function"&&(d[b]=function(){})})}function o(a,b,c){e=l(D),bc.setCursor(a==="move"?a:a+"-resize");if(a==="move")return bc.activateHandlers(q(b),v,c);var d=_.getFixed(),f=r(a),g=_.getCorner(r(f));_.setPressed(_.getCorner(f)),_.setCurrent(g),bc.activateHandlers(p(a,d),v,c)}function p(a,b){return function(c){if(!d.aspectRatio)switch(a){case"e":c[1]=b.y2;break;case"w":c[1]=b.y2;break;case"n":c[0]=b.x2;break;case"s":c[0]=b.x2}else switch(a){case"e":c[1]=b.y+1;break;case"w":c[1]=b.y+1;break;case"n":c[0]=b.x+1;break;case"s":c[0]=b.x+1}_.setCurrent(c),bb.update()}}function q(a){var b=a;return bd.watchKeys
(),function(a){_.moveOffset([a[0]-b[0],a[1]-b[1]]),b=a,bb.update()}}function r(a){switch(a){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function s(a){return function(b){return d.disabled?!1:a==="move"&&!d.allowMove?!1:(e=l(D),W=!0,o(a,m(b)),b.stopPropagation(),b.preventDefault(),!1)}}function t(a,b,c){var d=a.width(),e=a.height();d>b&&b>0&&(d=b,e=b/a.width()*a.height()),e>c&&c>0&&(e=c,d=c/a.height()*a.width()),T=a.width()/d,U=a.height()/e,a.width(d).height(e)}function u(a){return{x:a.x*T,y:a.y*U,x2:a.x2*T,y2:a.y2*U,w:a.w*T,h:a.h*U}}function v(a){var b=_.getFixed();b.w>d.minSelect[0]&&b.h>d.minSelect[1]?(bb.enableHandles(),bb.done()):bb.release(),bc.setCursor(d.allowSelect?"crosshair":"default")}function w(a){if(d.disabled)return!1;if(!d.allowSelect)return!1;W=!0,e=l(D),bb.disableHandles(),bc.setCursor("crosshair");var b=m(a);return _.setPressed(b),bb.update(),bc.activateHandlers(x,v,a.type.substring
(0,5)==="touch"),bd.watchKeys(),a.stopPropagation(),a.preventDefault(),!1}function x(a){_.setCurrent(a),bb.update()}function y(){var b=a("<div></div>").addClass(j("tracker"));return g&&b.css({opacity:0,backgroundColor:"white"}),b}function be(a){G.removeClass().addClass(j("holder")).addClass(a)}function bf(a,b){function t(){window.setTimeout(u,l)}var c=a[0]/T,e=a[1]/U,f=a[2]/T,g=a[3]/U;if(X)return;var h=_.flipCoords(c,e,f,g),i=_.getFixed(),j=[i.x,i.y,i.x2,i.y2],k=j,l=d.animationDelay,m=h[0]-j[0],n=h[1]-j[1],o=h[2]-j[2],p=h[3]-j[3],q=0,r=d.swingSpeed;c=k[0],e=k[1],f=k[2],g=k[3],bb.animMode(!0);var s,u=function(){return function(){q+=(100-q)/r,k[0]=Math.round(c+q/100*m),k[1]=Math.round(e+q/100*n),k[2]=Math.round(f+q/100*o),k[3]=Math.round(g+q/100*p),q>=99.8&&(q=100),q<100?(bh(k),t()):(bb.done(),bb.animMode(!1),typeof b=="function"&&b.call(bs))}}();t()}function bg(a){bh([a[0]/T,a[1]/U,a[2]/T,a[3]/U]),d.onSelect.call(bs,u(_.getFixed())),bb.enableHandles()}function bh(a){_.setPressed([a[0],a[1]]),_.setCurrent([a[2],a[3]]),bb.update()}function bi(){return u(_.getFixed())}function bj(){return _.getFixed()}function bk(a){n(a),br()}function bl(){d.disabled=!0,bb.disableHandles(),bb.setCursor("default"),bc.setCursor("default")}function bm(){d.disabled=!1,br()}function bn(){bb.done(),bc.activateHandlers(null,null)}function bo(){G.remove(),A.show(),A.css("visibility","visible"),a(b).removeData("Jcrop")}function bp(a,b){bb.release(),bl();var c=new Image;c.onload=function(){var e=c.width,f=c.height,g=d.boxWidth,h=d.boxHeight;D.width(e).height(f),D.attr("src",a),H.attr("src",a),t(D,g,h),E=D.width(),F=D.height(),H.width(E).height(F),M.width(E+L*2).height(F+L*2),G.width(E).height(F),ba.resize(E,F),bm(),typeof b=="function"&&b.call(bs)},c.src=a}function bq(a,b,c){var e=b||d.bgColor;d.bgFade&&k()&&d.fadeTime&&!c?a.animate({backgroundColor:e},{queue:!1,duration:d.fadeTime}):a.css("backgroundColor",e)}function br(a){d.allowResize?a?bb.enableOnly():bb.enableHandles():bb.disableHandles(),bc.setCursor(d.allowSelect?"crosshair":"default"),bb.setCursor(d.allowMove?"move":"default"),d.hasOwnProperty("trueSize")&&(T=d.trueSize[0]/E,U=d.trueSize[1]/F),d.hasOwnProperty("setSelect")&&(bg(d.setSelect),bb.done(),delete d.setSelect),ba.refresh(),d.bgColor!=N&&(bq(d.shade?ba.getShades():G,d.shade?d.shadeColor||d.bgColor:d.bgColor),N=d.bgColor),O!=d.bgOpacity&&(O=d.bgOpacity,d.shade?ba.refresh():bb.setBgOpacity(O)),P=d.maxSize[0]||0,Q=d.maxSize[1]||0,R=d.minSize[0]||0,S=d.minSize[1]||0,d.hasOwnProperty("outerImage")&&(D.attr("src",d.outerImage),delete d.outerImage),bb.refresh()}var d=a.extend({},a.Jcrop.defaults),e,f=navigator.userAgent.toLowerCase(),g=/msie/.test(f),h=/msie [1-6]\./.test(f);typeof b!="object"&&(b=a(b)[0]),typeof c!="object"&&(c={}),n(c);var z={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0},A=a(b),B=!0;if(b.tagName=="IMG"){if(A[0].width!=0&&A[0].height!=0)A.width(A[0].width),A.height(A[0].height);else{var C=new Image;C.src=A[0].src,A.width(C.width),A.height(C.height)}var D=A.clone().removeAttr("id").css(z).show();D.width(A.width()),D.height(A.height()),A.after(D).hide()}else D=A.css(z).show(),B=!1,d.shade===null&&(d.shade=!0);t(D,d.boxWidth,d.boxHeight);var E=D.width(),F=D.height(),G=a("<div />").width(E).height(F).addClass(j("holder")).css({position:"relative",backgroundColor:d.bgColor}).insertAfter(A).append(D);d.addClass&&G.addClass(d.addClass);var H=a("<div />"),I=a("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),J=a("<div />").width("100%").height("100%").css("zIndex",320),K=a("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var a=_.getFixed();d.onDblClick.call(bs,a)}).insertBefore(D).append(I,J);B&&(H=a("<img />").attr("src",D.attr("src")).css(z).width(E).height(F),I.append(H)),h&&K.css({overflowY:"hidden"});var L=d.boundary,M=y().width(E+L*2).height(F+L*2).css({position:"absolute",top:i(-L),left:i(-L),zIndex:290}).mousedown(w),N=d.bgColor,O=d.bgOpacity,P,Q,R,S,T,U,V=!0,W,X,Y;e=l(D);var Z=function(){function a(){var a={},b=["touchstart","touchmove","touchend"],c=document.createElement("div"),d;try{for(d=0;d<b.length;d++){var e=b[d];e="on"+e;var f=e in c;f||(c.setAttribute(e,"return;"),f=typeof c[e]=="function"),a[b[d]]=f}return a.touchstart&&a.touchend&&a.touchmove}catch(g){return!1}}function b(){return d.touchSupport===!0||d.touchSupport===!1?d.touchSupport:a()}return{createDragger:function(a){return function(b){return d.disabled?!1:a==="move"&&!d.allowMove?!1:(e=l(D),W=!0,o(a,m(Z.cfilter(b)),!0),b.stopPropagation(),b.preventDefault(),!1)}},newSelection:function(a){return w(Z.cfilter(a))},cfilter:function(a){return a.pageX=a.originalEvent.changedTouches[0].pageX,a.pageY=a.originalEvent.changedTouches[0].pageY,a},isSupported:a,support:b()}}(),_=function(){function h(d){d=n(d),c=a=d[0],e=b=d[1]}function i(a){a=n(a),f=a[0]-c,g=a[1]-e,c=a[0],e=a[1]}function j(){return[f,g]}function k(d){var f=d[0],g=d[1];0>a+f&&(f-=f+a),0>b+g&&(g-=g+b),F<e+g&&(g+=F-(e+g)),E<c+f&&(f+=E-(c+f)),a+=f,c+=f,b+=g,e+=g}function l(a){var b=m();switch(a){case"ne":return[b.x2,b.y];case"nw":return[b.x,b.y];case"se":return[b.x2,b.y2];case"sw":return[b.x,b.y2]}}function m(){if(!d.aspectRatio)return p();var f=d.aspectRatio,g=d.minSize[0]/T,h=d.maxSize[0]/T,i=d.maxSize[1]/U,j=c-a,k=e-b,l=Math.abs(j),m=Math.abs(k),n=l/m,r,s,t,u;return h===0&&(h=E*10),i===0&&(i=F*10),n<f?(s=e,t=m*f,r=j<0?a-t:t+a,r<0?(r=0,u=Math.abs((r-a)/f),s=k<0?b-u:u+b):r>E&&(r=E,u=Math.abs((r-a)/f),s=k<0?b-u:u+b)):(r=c,u=l/f,s=k<0?b-u:b+u,s<0?(s=0,t=Math.abs((s-b)*f),r=j<0?a-t:t+a):s>F&&(s=F,t=Math.abs(s-b)*f,r=j<0?a-t:t+a)),r>a?(r-a<g?r=a+g:r-a>h&&(r=a+h),s>b?s=b+(r-a)/f:s=b-(r-a)/f):r<a&&(a-r<g?r=a-g:a-r>h&&(r=a-h),s>b?s=b+(a-r)/f:s=b-(a-r)/f),r<0?(a-=r,r=0):r>E&&(a-=r-E,r=E),s<0?(b-=s,s=0):s>F&&(b-=s-F,s=F),q(o(a,b,r,s))}function n(a){return a[0]<0&&(a[0]=0),a[1]<0&&(a[1]=0),a[0]>E&&(a[0]=E),a[1]>F&&(a[1]=F),[Math.round(a[0]),Math.round(a[1])]}function o(a,b,c,d){var e=a,f=c,g=b,h=d;return c<a&&(e=c,f=a),d<b&&(g=d,h=b),[e,g,f,h]}function p(){var d=c-a,f=e-b,g;return P&&Math.abs(d)>P&&(c=d>0?a+P:a-P),Q&&Math.abs
(f)>Q&&(e=f>0?b+Q:b-Q),S/U&&Math.abs(f)<S/U&&(e=f>0?b+S/U:b-S/U),R/T&&Math.abs(d)<R/T&&(c=d>0?a+R/T:a-R/T),a<0&&(c-=a,a-=a),b<0&&(e-=b,b-=b),c<0&&(a-=c,c-=c),e<0&&(b-=e,e-=e),c>E&&(g=c-E,a-=g,c-=g),e>F&&(g=e-F,b-=g,e-=g),a>E&&(g=a-F,e-=g,b-=g),b>F&&(g=b-F,e-=g,b-=g),q(o(a,b,c,e))}function q(a){return{x:a[0],y:a[1],x2:a[2],y2:a[3],w:a[2]-a[0],h:a[3]-a[1]}}var a=0,b=0,c=0,e=0,f,g;return{flipCoords:o,setPressed:h,setCurrent:i,getOffset:j,moveOffset:k,getCorner:l,getFixed:m}}(),ba=function(){function f(a,b){e.left.css({height:i(b)}),e.right.css({height:i(b)})}function g(){return h(_.getFixed())}function h(a){e.top.css({left:i(a.x),width:i(a.w),height:i(a.y)}),e.bottom.css({top:i(a.y2),left:i(a.x),width:i(a.w),height:i(F-a.y2)}),e.right.css({left:i(a.x2),width:i(E-a.x2)}),e.left.css({width:i(a.x)})}function j(){return a("<div />").css({position:"absolute",backgroundColor:d.shadeColor||d.bgColor}).appendTo(c)}function k(){b||(b=!0,c.insertBefore(D),g(),bb.setBgOpacity(1,0,1),H.hide(),l(d.shadeColor||d.bgColor,1),bb.isAwake()?n(d.bgOpacity,1):n(1,1))}function l(a,b){bq(p(),a,b)}function m(){b&&(c.remove(),H.show(),b=!1,bb.isAwake()?bb.setBgOpacity(d.bgOpacity,1,1):(bb.setBgOpacity(1,1,1),bb.disableHandles()),bq(G,0,1))}function n(a,e){b&&(d.bgFade&&!e?c.animate({opacity:1-a},{queue:!1,duration:d.fadeTime}):c.css({opacity:1-a}))}function o(){d.shade?k():m(),bb.isAwake()&&n(d.bgOpacity)}function p(){return c.children()}var b=!1,c=a("<div />").css({position:"absolute",zIndex:240,opacity:0}),e={top:j(),left:j().height(F),right:j().height(F),bottom:j()};return{update:g,updateRaw:h,getShades:p,setBgColor:l,enable:k,disable:m,resize:f,refresh:o,opacity:n}}(),bb=function(){function k(b){var c=a("<div />").css({position:"absolute",opacity:d.borderOpacity}).addClass(j(b));return I.append(c),c}function l(b,c){var d=a("<div />").mousedown(s(b)).css({cursor:b+"-resize",position:"absolute",zIndex:c}).addClass("ord-"+b);return Z.support&&d.bind("touchstart.jcrop",Z.createDragger(b)),J.append(d),d}function m(a){var b=d.handleSize,e=l(a,c++).css({opacity:d.handleOpacity}).addClass(j("handle"));return b&&e.width(b).height(b),e}function n(a){return l(a,c++).addClass("jcrop-dragbar")}function o(a){var b;for(b=0;b<a.length;b++)g[a[b]]=n(a[b])}function p(a){var b,c;for(c=0;c<a.length;c++){switch(a[c]){case"n":b="hline";break;case"s":b="hline bottom";break;case"e":b="vline right";break;case"w":b="vline"}e[a[c]]=k(b)}}function q(a){var b;for(b=0;b<a.length;b++)f[a[b]]=m(a[b])}function r(a,b){d.shade||H.css({top:i(-b),left:i(-a)}),K.css({top:i(b),left:i(a)})}function t(a,b){K.width(Math.round(a)).height(Math.round(b))}function v(){var a=_.getFixed();_.setPressed([a.x,a.y]),_.setCurrent([a.x2,a.y2]),w()}function w(a){if(b)return x(a)}function x(a){var c=_.getFixed();t(c.w,c.h),r(c.x,c.y),d.shade&&ba.updateRaw(c),b||A(),a?d.onSelect.call(bs,u(c)):d.onChange.call(bs,u(c))}function z(a,c,e){if(!b&&!c)return;d.bgFade&&!e?D.animate({opacity:a},{queue:!1,duration:d.fadeTime}):D.css("opacity",a)}function A(){K.show(),d.shade?ba.opacity(O):z(O,!0),b=!0}function B
(){F(),K.hide(),d.shade?ba.opacity(1):z(1),b=!1,d.onRelease.call(bs)}function C(){h&&J.show()}function E(){h=!0;if(d.allowResize)return J.show(),!0}function F(){h=!1,J.hide()}function G(a){a?(X=!0,F()):(X=!1,E())}function L(){G(!1),v()}var b,c=370,e={},f={},g={},h=!1;d.dragEdges&&a.isArray(d.createDragbars)&&o(d.createDragbars),a.isArray(d.createHandles)&&q(d.createHandles),d.drawBorders&&a.isArray(d.createBorders)&&p(d.createBorders),a(document).bind("touchstart.jcrop-ios",function(b){a(b.currentTarget).hasClass("jcrop-tracker")&&b.stopPropagation()});var M=y().mousedown(s("move")).css({cursor:"move",position:"absolute",zIndex:360});return Z.support&&M.bind("touchstart.jcrop",Z.createDragger("move")),I.append(M),F(),{updateVisible:w,update:x,release:B,refresh:v,isAwake:function(){return b},setCursor:function(a){M.css("cursor",a)},enableHandles:E,enableOnly:function(){h=!0},showHandles:C,disableHandles:F,animMode:G,setBgOpacity:z,done:L}}(),bc=function(){function f(b){M.css({zIndex:450}),b?a(document).bind("touchmove.jcrop",k).bind("touchend.jcrop",l):e&&a(document).bind("mousemove.jcrop",h).bind("mouseup.jcrop",i)}function g(){M.css({zIndex:290}),a(document).unbind(".jcrop")}function h(a){return b(m(a)),!1}function i(a){return a.preventDefault(),a.stopPropagation(),W&&(W=!1,c(m(a)),bb.isAwake()&&d.onSelect.call(bs,u(_.getFixed())),g(),b=function(){},c=function(){}),!1}function j(a,d,e){return W=!0,b=a,c=d,f(e),!1}function k(a){return b(m(Z.cfilter(a))),!1}function l(a){return i(Z.cfilter(a))}function n(a){M.css("cursor",a)}var b=function(){},c=function(){},e=d.trackDocument;return e||M.mousemove(h).mouseup(i).mouseout(i),D.before(M),{activateHandlers:j,setCursor:n}}(),bd=function(){function e(){d.keySupport&&(b.show(),b.focus())}function f(a){b.hide()}function g(a,b,c){d.allowMove&&(_.moveOffset([b,c]),bb.updateVisible(!0)),a.preventDefault(),a.stopPropagation()}function i(a){if(a.ctrlKey||a.metaKey)return!0;Y=a.shiftKey?!0:!1;var b=Y?10:1;switch(a.keyCode){case 37:g(a,-b,0);break;case 39:g(a,b,0);break;case 38:g(a,0,-b);break;case 40:g(a,0,b);break;case 27:d.allowSelect&&bb.release();break;case 9:return!0}return!1}var b=a('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),c=a("<div />").css({position:"absolute",overflow:"hidden"}).append(b);return d.keySupport&&(b.keydown(i).blur(f),h||!d.fixedSupport?(b.css({position:"absolute",left:"-20px"}),c.append(b).insertBefore(D)):b.insertBefore(D)),{watchKeys:e}}();Z.support&&M.bind("touchstart.jcrop",Z.newSelection),J.hide(),br(!0);var bs={setImage:bp,animateTo:bf,setSelect:bg,setOptions:bk,tellSelect:bi,tellScaled:bj,setClass:be,disable:bl,enable:bm,cancel:bn,release:bb.release,destroy:bo,focus:bd.watchKeys,getBounds:function(){return[E*T,F*U]},getWidgetSize:function(){return[E,F]},getScaleFactor:function(){return[T,U]},getOptions:function(){return d},ui:{holder:G,selection:K}};return g&&G.bind("selectstart",function(){return!1}),A.data("Jcrop",bs),bs},a.fn.Jcrop=function(b,c){var d;return this.each(function(){if(a(this).data("Jcrop")){if(b==="api")return a(this).data("Jcrop");a(this).data("Jcrop").setOptions(b)}else this.tagName=="IMG"?a.Jcrop.Loader(this,function(){a(this).css({display:"block",visibility:"hidden"}),d=a.Jcrop(this,b),a.isFunction(c)&&c.call(d)}):(a(this).css({display:"block",visibility:"hidden"}),d=a.Jcrop(this,b),a.isFunction(c)&&c.call(d))}),this},a.Jcrop.Loader=function(b,c,d){function g(){f.complete?(e.unbind(".jcloader"),a.isFunction(c)&&c.call(f)):window.setTimeout(g,50)}var e=a(b),f=e[0];e.bind("load.jcloader",g).bind("error.jcloader",function(b){e.unbind(".jcloader"),a.isFunction(d)&&d.call(f)}),f.complete&&a.isFunction(c)&&(e.unbind(".jcloader"),c.call(f))},a.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}})(jQuery);
(function($){$.fn.autoGrowInput=function(o){o=$.extend({maxWidth:1000,minWidth:0,comfortZone:70},o);this.filter('input:text').each(function(){var minWidth=o.minWidth||$(this).width(),val='',input=$(this),testSubject=$('<tester/>').css({position:'absolute',top:-9999,left:-9999,width:'auto',fontSize:input.css('fontSize'),fontFamily:input.css('fontFamily'),fontWeight:input.css('fontWeight'),letterSpacing:input.css('letterSpacing'),whiteSpace:'nowrap'}),check=function(){if(val===(val=input.val())){return;}
var escaped=val.replace(/&/g,'&amp;').replace(/\s/g,'&nbsp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');testSubject.html(escaped);var testerWidth=testSubject.width(),newWidth=(testerWidth+o.comfortZone)>=minWidth?testerWidth+o.comfortZone:minWidth,currentWidth=input.width(),isValidWidthChange=(newWidth<currentWidth&&newWidth>=minWidth)||(newWidth>minWidth&&newWidth<o.maxWidth);if(isValidWidthChange){input.width(newWidth);}};testSubject.insertAfter(input);$(this).bind('keyup keydown blur update',check);check();});return this;};})(jQuery);
(function($){$.fn.tagedit=function(options){options=$.extend(true,{autocompleteURL:null,deletedPostfix:'-d',addedPostfix:'-a',additionalListClass:'',allowEdit:true,allowDelete:true,allowAdd:true,direction:'ltr',animSpeed:500,autocompleteOptions:{select:function(event,ui){$(this).val(ui.item.value).trigger('transformToTag',[ui.item.id]);return false;}},breakKeyCodes:[13,44],checkNewEntriesCaseSensitive:false,texts:{removeLinkTitle:'Entfernen',saveEditLinkTitle:'Änderungen speichern.',deleteLinkTitle:'Tag aus Datenbank löschen.',deleteConfirmation:'Sicher das Du diesen EIntrag löschen willst?',deletedElementTitle:'Das Element wurde gelöscht.',breakEditLinkTitle:'Abbrechen'}},options||{});if(this.length==0){return;}
if(options.autocompleteURL){options.autocompleteOptions.source=options.autocompleteURL;}
var direction=this.attr('dir');if(direction&&direction.length>0){options.direction=this.attr('dir');}
var elements=this;var baseNameRegexp=new RegExp("^(.*)\\[([0-9]*?("+options.deletedPostfix+"|"+options.addedPostfix+")?)?\]$","i");var baseName=elements.eq(0).attr('name').match(baseNameRegexp);if(baseName&&baseName.length==4){baseName=baseName[1];}
else{alert('elementname dows not match the expected format (regexp: '+baseNameRegexp+')')
return;}
inputsToList();function inputsToList(){var html='<ul class="tagedit-list '+options.additionalListClass+'">';elements.each(function(){var element_name=$(this).attr('name').match(baseNameRegexp);if(element_name&&element_name.length==4&&(options.deleteEmptyItems==false||$(this).val().length>0)){if(element_name[1].length>0){var elementId=typeof element_name[2]!='undefined'?element_name[2]:'';html+='<li class="tagedit-listelement tagedit-listelement-old">';html+='<span dir="'+options.direction+'">'+$(this).val()+'</span>';html+='<input type="hidden" name="'+baseName+'['+elementId+']" value="'+$(this).val()+'" />';html+='<a class="tagedit-close" title="'+options.texts.removeLinkTitle+'">x</a>';html+='</li>';}}});elements.last().after(html)
var newList=elements.last().next();elements.remove();elements=newList;if(options.deletedPostfix.length>0){elements.find('input[name$="'+options.deletedPostfix+'\]"]').each(function(){markAsDeleted($(this).parent());});}
html='<li class="tagedit-listelement tagedit-listelement-new">';html+='<input type="text" name="'+baseName+'[]" value="" id="tagedit-input" disabled="disabled" class="tagedit-input-disabled" dir="'+options.direction+'"/>';html+='</li>';html+='</ul>';elements.append(html).find('#tagedit-input').each(function(){$(this).autoGrowInput({comfortZone:15,minWidth:15,maxWidth:20000});$(this).bind('transformToTag',function(event,id){var oldValue=(typeof id!='undefined'&&id.length>0);var checkAutocomplete=oldValue==true?false:true;var isNewResult=isNew($(this).val(),checkAutocomplete);if(isNewResult[0]===true||(isNewResult[0]===false&&typeof isNewResult[1]=='string')){if(oldValue==false&&typeof isNewResult[1]=='string'){oldValue=true;id=isNewResult[1];}
if(options.allowAdd==true||oldValue){html='<li class="tagedit-listelement tagedit-listelement-old">';html+='<span dir="'+options.direction+'">'+$(this).val()+'</span>';var name=oldValue?baseName+'['+id+options.addedPostfix+']':baseName+'[]';html+='<input type="hidden" name="'+name+'" value="'+$(this).val()+'" />';html+='<a class="tagedit-close" title="'+options.texts.removeLinkTitle+'">x</a>';html+='</li>';$(this).parent().before(html);}}
$(this).val('');if(options.autocompleteOptions.source){$(this).autocomplete("close");}}).keydown(function(event){var code=event.keyCode>0?event.keyCode:event.which;switch(code){case 8:if($(this).val().length==0){var elementToRemove=elements.find('li.tagedit-listelement-old').last();elementToRemove.fadeOut(options.animSpeed,function(){elementToRemove.remove();})
event.preventDefault();return false;}
break;case 9:if($(this).val().length>0&&$('ul.ui-autocomplete #ui-active-menuitem').length==0){$(this).trigger('transformToTag');event.preventDefault();return false;}
break;}
return true;}).keypress(function(event){var code=event.keyCode>0?event.keyCode:event.which;if($.inArray(code,options.breakKeyCodes)>-1){if($(this).val().length>0&&$('ul.ui-autocomplete #ui-active-menuitem').length==0){$(this).trigger('transformToTag');}
event.preventDefault();return false;}
return true;}).bind('paste',function(e){var that=$(this);if(e.type=='paste'){setTimeout(function(){that.trigger('transformToTag');},1);}}).blur(function(){if($(this).val().length==0){$(this).attr('disabled','disabled').addClass('tagedit-input-disabled');}
else{var input=$(this);$(this).data('blurtimer',window.setTimeout(function(){input.val('');},500));}}).focus(function(){window.clearTimeout($(this).data('blurtimer'));});if(options.autocompleteOptions.source!=false){$(this).autocomplete(options.autocompleteOptions);}}).end().click(function(event){switch(event.target.tagName){case'A':$(event.target).parent().fadeOut(options.animSpeed,function(){$(event.target).parent().remove();});break;case'INPUT':case'SPAN':case'LI':if($(event.target).hasClass('tagedit-listelement-deleted')==false&&$(event.target).parent('li').hasClass('tagedit-listelement-deleted')==false){return doEdit(event);}
default:$(this).find('#tagedit-input').removeAttr('disabled').removeClass('tagedit-input-disabled').focus();}
return false;})}
function doEdit(event){if(options.allowEdit==false){return;}
var element=event.target.tagName=='SPAN'?$(event.target).parent():$(event.target);var closeTimer=null;element.bind('finishEdit',function(event,doReset){window.clearTimeout(closeTimer);var textfield=$(this).find(':text');var isNewResult=isNew(textfield.val(),true);if(textfield.val().length>0&&(typeof doReset=='undefined'||doReset===false)&&(isNewResult[0]==true)){$(this).find(':hidden').val(textfield.val());$(this).find('span').html(textfield.val());}
textfield.remove();$(this).find('a.tagedit-save, a.tagedit-break, a.tagedit-delete, tester').remove();$(this).removeClass('tagedit-listelement-edit').unbind('finishEdit');return false;});var hidden=element.find(':hidden');html='<input type="text" name="tmpinput" autocomplete="off" value="'+hidden.val()+'" class="tagedit-edit-input" dir="'+options.direction+'"/>';html+='<a class="tagedit-save" title="'+options.texts.saveEditLinkTitle+'">o</a>';html+='<a class="tagedit-break" title="'+options.texts.breakEditLinkTitle+'">x</a>';if(options.allowDelete==true&&element.find(':hidden').length>0&&typeof element.find(':hidden').attr('name').match(baseNameRegexp)[3]!='undefined'){html+='<a class="tagedit-delete" title="'+options.texts.deleteLinkTitle+'">d</a>';}
hidden.after(html);element.addClass('tagedit-listelement-edit').find('a.tagedit-save').click(function(){$(this).parent().trigger('finishEdit');return false;}).end().find('a.tagedit-break').click(function(){$(this).parent().trigger('finishEdit',[true]);return false;}).end().find('a.tagedit-delete').click(function(){window.clearTimeout(closeTimer);if(confirm(options.texts.deleteConfirmation)){markAsDeleted($(this).parent());}
else{$(this).parent().find(':text').trigger('finishEdit',[true]);}
return false;}).end().find(':text').focus().autoGrowInput({comfortZone:10,minWidth:15,maxWidth:20000}).keypress(function(event){switch(event.keyCode){case 13:event.preventDefault();$(this).parent().trigger('finishEdit');return false;case 27:event.preventDefault();$(this).parent().trigger('finishEdit',[true]);return false;}
return true;}).blur(function(){var that=$(this);closeTimer=window.setTimeout(function(){that.parent().trigger('finishEdit',[true])},500);});}
function markAsDeleted(element){element.trigger('finishEdit',[true]).addClass('tagedit-listelement-deleted').attr('title',options.deletedElementTitle);element.find(':hidden').each(function(){var nameEndRegexp=new RegExp('('+options.addedPostfix+'|'+options.deletedPostfix+')?\]');var name=$(this).attr('name').replace(nameEndRegexp,options.deletedPostfix+']');$(this).attr('name',name);});}
function isNew(value,checkAutocomplete){checkAutocomplete=typeof checkAutocomplete=='undefined'?false:checkAutocomplete;var autoCompleteId=null;var compareValue=options.checkNewEntriesCaseSensitive==true?value:value.toLowerCase();var isNew=true;elements.find('li.tagedit-listelement-old input:hidden').each(function(){var elementValue=options.checkNewEntriesCaseSensitive==true?$(this).val():$(this).val().toLowerCase();if(elementValue==compareValue){isNew=false;}});if(isNew==true&&checkAutocomplete==true&&options.autocompleteOptions.source!=false){var result=[];if($.isArray(options.autocompleteOptions.source)){result=options.autocompleteOptions.source;}
else if($.isFunction(options.autocompleteOptions.source)){options.autocompleteOptions.source({term:value},function(data){result=data});}
else if(typeof options.autocompleteOptions.source==="string"){var autocompleteURL=options.autocompleteOptions.source;if(autocompleteURL.match(/\?/)){autocompleteURL+='&';}else{autocompleteURL+='?';}
autocompleteURL+='term='+value;$.ajax({async:false,url:autocompleteURL,dataType:'json',complete:function(XMLHttpRequest,textStatus){result=$.parseJSON(XMLHttpRequest.responseText);}});}
for(var i=0;i<result.length;i++){var label=options.checkNewEntriesCaseSensitive==true?result[i].label:result[i].label.toLowerCase();if(label==compareValue){isNew=false;autoCompleteId=result[i].id;break;}}}
return new Array(isNew,autoCompleteId);}}})(jQuery);
(function(factory){if(typeof define==='function'&&define.amd){define(['jquery'],factory);}else{factory(jQuery);}}(function($){$.timeago=function(timestamp){if(timestamp instanceof Date){return inWords(timestamp);}else if(typeof timestamp==="string"){return inWords($.timeago.parse(timestamp));}else if(typeof timestamp==="number"){return inWords(new Date(timestamp));}else{return inWords($.timeago.datetime(timestamp));}};var $t=$.timeago;$.extend($.timeago,{settings:{refreshMillis:60000,allowFuture:false,localeTitle:false,cutoff:0,strings:{prefixAgo:"vor",prefixFromNow:"in",suffixAgo:"",suffixFromNow:"",seconds:"wenigen Sekunden",minute:"etwa einer Minute",minutes:"%d Minuten",hour:"etwa einer Stunde",hours:"%d Stunden",day:"etwa einem Tag",days:"%d Tagen",month:"etwa einem Monat",months:"%d Monaten",year:"etwa einem Jahr",years:"%d Jahren"}},inWords:function(distanceMillis){var $l=this.settings.strings;var prefix=$l.prefixAgo;var suffix=$l.suffixAgo;if(this.settings.allowFuture){if(distanceMillis<0){prefix=$l.prefixFromNow;suffix=$l.suffixFromNow;}}
var seconds=Math.abs(distanceMillis)/1000;var minutes=seconds/60;var hours=minutes/60;var days=hours/24;var years=days/365;function substitute(stringOrFunction,number){var string=$.isFunction(stringOrFunction)?stringOrFunction(number,distanceMillis):stringOrFunction;var value=($l.numbers&&$l.numbers[number])||number;return string.replace(/%d/i,value);}
var words=seconds<45&&substitute($l.seconds,Math.round(seconds))||seconds<90&&substitute($l.minute,1)||minutes<45&&substitute($l.minutes,Math.round(minutes))||minutes<90&&substitute($l.hour,1)||hours<24&&substitute($l.hours,Math.round(hours))||hours<42&&substitute($l.day,1)||days<30&&substitute($l.days,Math.round(days))||days<45&&substitute($l.month,1)||days<365&&substitute($l.months,Math.round(days/30))||years<1.5&&substitute($l.year,1)||substitute($l.years,Math.round(years));var separator=$l.wordSeparator||"";if($l.wordSeparator===undefined){separator=" ";}
return $.trim([prefix,words,suffix].join(separator));},parse:function(iso8601){var s=$.trim(iso8601);s=s.replace(/\.\d+/,"");s=s.replace(/-/,"/").replace(/-/,"/");s=s.replace(/T/," ").replace(/Z/," UTC");s=s.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2");s=s.replace(/([\+\-]\d\d)$/," $100");return new Date(s);},datetime:function(elem){var iso8601=$t.isTime(elem)?$(elem).attr("datetime"):$(elem).attr("title");return $t.parse(iso8601);},isTime:function(elem){return $(elem).get(0).tagName.toLowerCase()==="time";}});var functions={init:function(){var refresh_el=$.proxy(refresh,this);refresh_el();var $s=$t.settings;if($s.refreshMillis>0){this._timeagoInterval=setInterval(refresh_el,$s.refreshMillis);}},update:function(time){var parsedTime=$t.parse(time);$(this).data('timeago',{datetime:parsedTime});if($t.settings.localeTitle)$(this).attr("title",parsedTime.toLocaleString());refresh.apply(this);},updateFromDOM:function(){$(this).data('timeago',{datetime:$t.parse($t.isTime(this)?$(this).attr("datetime"):$(this).attr("title"))});refresh.apply(this);},dispose:function(){if(this._timeagoInterval){window.clearInterval(this._timeagoInterval);this._timeagoInterval=null;}}};$.fn.timeago=function(action,options){var fn=action?functions[action]:functions.init;if(!fn){throw new Error("Unknown function name '"+action+"' for timeago");}
this.each(function(){fn.call(this,options);});return this;};function refresh(){var data=prepareData(this);var $s=$t.settings;if(!isNaN(data.datetime)){if($s.cutoff==0||distance(data.datetime)<$s.cutoff){$(this).text(inWords(data.datetime));}}
return this;}
function prepareData(element){element=$(element);if(!element.data("timeago")){element.data("timeago",{datetime:$t.datetime(element)});var text=$.trim(element.text());if($t.settings.localeTitle){element.attr("title",element.data('timeago').datetime.toLocaleString());}else if(text.length>0&&!($t.isTime(element)&&element.attr("title"))){element.attr("title",text);}}
return element.data("timeago");}
function inWords(date){return $t.inWords(distance(date));}
function distance(date){return(new Date().getTime()-date.getTime());}
document.createElement("abbr");document.createElement("time");}));
(function(){var autoLink,__slice=[].slice;autoLink=function(){var k,linkAttributes,option,options,pattern,v;options=1<=arguments.length?__slice.call(arguments,0):[];pattern=/(^|\s)((?:https?|ftp):\/\/[\-A-Z0-9+\u0026@#\/%?=()~_|!:,.;]*[\-A-Z0-9+\u0026@#\/%=~()_|])/gi;if(!(options.length>0)){return this.replace(pattern,"$1<a href='$2'>$2</a>");}
option=options[0];linkAttributes=((function(){var _results;_results=[];for(k in option){v=option[k];if(k!=='callback'){_results.push(" "+k+"='"+v+"'");}}
return _results;})()).join('');return this.replace(pattern,function(match,space,url){var link;link=(typeof option.callback==="function"?option.callback(url):void 0)||("<a href='"+url+"'"+linkAttributes+">"+url.replace('http://','').replace('https://','')+"</a>");return""+space+link;});};String.prototype['autoLink']=autoLink;}).call(this);
HTTP_GET_VARS=new Array();strGET=document.location.search.substr(1,document.location.search.length);var data=null;if(strGET!='')
{gArr=strGET.split('&');for(i=0;i<gArr.length;++i)
{v='';vArr=gArr[i].split('=');if(vArr.length>1){v=vArr[1];}
HTTP_GET_VARS[unescape(vArr[0])]=unescape(v);}}
function isMobile()
{width=$(window).width();if(width<480)
{return true;}
return false;}
function GET(v)
{if(!HTTP_GET_VARS[v]){return'undefined';}
return HTTP_GET_VARS[v];}
$(document).ready(function(){$('textarea.comment').autosize();$('#nojs').css('display','none');$('#main').css('display','block');$('.moreswap').each(function(){$this=$(this);$this.after('<a class="moreswaplink" href="#" data-show="0">Mehr anzeigen</a>');if($this.height()>100)
{$this.css({'height':'100px','overflow':'hidden'});}});$('.moreswaplink').each(function(){$this=$(this);$this.click(function(ev){ev.preventDefault();if($this.attr('data-show')==0)
{$this.prev().css({'height':'auto','overflow':'visible'});$this.text('einklappen');$this.attr('data-show',1);}
else
{$this.prev().css({'height':'100px','overflow':'hidden'});$this.text('Mehr anzeigen');$this.attr('data-show',0);}});});if(isMob())
{$("#mobilemenu, .v-mob").show();$("#mainMenu, .v-desktop").hide();}
else
{$("#mainMenu, .v-desktop").show();$("#mobilemenu, .v-mob").hide();}
$(window).resize(function(){if(isMob())
{$("#mobilemenu, .v-mob").show();$("#mainMenu, .v-desktop").hide();}
else
{$("#mainMenu, .v-desktop").show();$("#mobilemenu, .v-mob").hide();}});$('textarea.inlabel, input.inlabel').each(function(){var $this=$(this);if($this.val()===''){$this.val($this.attr('title'));}
$this.focus(function(){if($this.val()===$this.attr('title')){$this.val('');}});$this.blur(function(){if($this.val()===''){$this.val($this.attr('title'));}});});infoMenu();$('#main a').tooltip({show:false,hide:false,content:function(){var el=$(this);if(el.attr('title').substring(0,4)=='#tt-')
{id=el.attr('title').substring(4);return $('.'+id).html();}
else
{return el.attr('title');}},position:{my:"center bottom-20",at:"center top",using:function(position,feedback){$(this).css(position);$("<div>").addClass("arrow").addClass(feedback.vertical).addClass(feedback.horizontal).appendTo(this);}}});$(function(){$("#dialog-confirm").dialog({resizable:false,height:140,modal:true,autoOpen:false,buttons:{"unwideruflich löschen":function(){goTo($('#dialog-confirm-url').val());$(this).dialog("close");},'Abbrechen':function(){$(this).dialog("close");}}});});$('.dialog').dialog();$('.v-switch').buttonset();$('#topmenu').buttonset();$('#topmenu').first().click();addHover('#mainMenu li');$("ul.toolbar li").hover(function(){$(this).addClass("ui-state-hover");},function(){$(this).removeClass("ui-state-hover");});$(".text, .textarea, select").focus(function(){$(this).addClass("focus");});$(".text, .textarea, select").blur(function(){$(this).removeClass("focus");});$(".value").blur(function(){el=$(this);if(el.val()!='')
{el.removeClass('input-error');}});$("#sendMail").dialog({autoOpen:false,modal:true,buttons:{"Senden":function()
{$.ajax({dataType:"json",url:"xhr.php?f=sendmail&sub="+$("#sendMail input:first").val()+"&msg="+encodeURIComponent($("#sendMail textarea").val()+'&fs='+$('#sendmail-fs-id').val()),success:function(data){if(data.status==1)
{$("#sendMail").dialog('close');$("#sendMail textarea").val('');info(data.msg);}
else
{alert(data);}}});}}});$("#uploadPhoto").dialog({autoOpen:false,modal:true,buttons:{"Upload":function()
{uploadPhoto();}}});$("#comment").dialog({autoOpen:false,modal:true,buttons:{"Speichern":function()
{$.ajax({dataType:"json",url:"xhr.php?f=addComment&name="+$('#comment-name').val()+"&id="+$('#comment-id').val()+"&comment="+encodeURIComponent($("#comment textarea").val()),success:function(data){if(data.status==1)
{$("#comment").dialog('close');$("#comment textarea").val('');info(data.msg);}
else
{alert(data);}}});}}});$('.toolbar-comment').click(function(){l=$(this).attr('attr').split(':');$('#comment-id').val(l[1]);$('#comment-name').val(l[0]);$('#comment').dialog('open');});$("#fancylink").fancybox({minWidth:470,maxWidth:470,minHeight:450,scrolling:"auto",beforeClose:function(){g_firstChatUpdate=true;},helpers:{overlay:{closeClick:false}}});});function chat(fsid)
{chatWith(fsid);}
function closeDialogs()
{$('.dialogbox').each(function(){if($(this).dialog("isOpen"))
{$(this).dialog("close");}});}
function addbanana(fsid)
{$('.vouch-banana').tooltip('close');$('#fsprofileratemsg-wrapper label').html($('.vouch-banana-title').html());$('#fsprofileratemsg-wrapper div.desc').html($('.vouch-banana-desc').html());$('#fsprofileratemsg').css({'height':'137px','width':'558px'});$('#fs-profile-rate-comment').dialog('option',{width:600,height:450});$('#fs-profile-rate-comment').dialog('open');}
function profile(id)
{showLoader();$.ajax({dataType:"json",url:"xhrapp.php?app=profile&m=quickprofile&id="+id,success:function(data){hideLoader();if(data.status==1)
{$('#tabs-profile').tabs("destroy");$('#dialog-profile-info').dialog("destroy");$("#u-profile").html(data.html);$('#tabs-profile').tabs();$('#dialog-profile-info').dialog({closeOnEscape:false,draggable:false,resizable:false,autoOpen:true,modal:true,width:470,open:function(){$(this).find('.ui-dialog-titlebar-close').blur();}}).parent().find('.ui-dialog-titlebar-close').prependTo('#tabs-profile').closest('.ui-dialog').children('.ui-dialog-titlebar').remove();$('#dialog-profile-info').css('padding','0');$('.ui-dialog-titlebar-close').css({'position':'absolute','right':'8px','top':'17px'});$("#tabs-profile").css({"border":"none","padding":"0"});$('.vouch-banana').tooltip({position:{my:"center bottom-20",at:"center top",using:function(position,feedback){$(this).css(position);$("<div>").addClass("arrow").addClass(feedback.vertical).addClass(feedback.horizontal).appendTo(this);}}});$('#fsprofileratemsg').val('');$('#tabs-profile').tabs('option',{heightStyle:'fill'});if(data.script!=undefined)
{$.globalEval(data.script);}}
else
{error(data.msg);}},complete:function(){hideLoader();}});}
function ajreq(name,options,method,app)
{opt={};if(options!=undefined)
{opt=options;}
if(method==undefined)
{method="get";}
if(app==undefined)
{app=GET('page');}
if(opt.app!=undefined)
{app=options.app;}
if(opt.loader==undefined||opt.loader==true)
{showLoader();}
$.ajax({url:"xhrapp.php?app="+app+"&m="+name,data:opt,dataType:'json',method:method,success:function(data){if(data.status==1)
{if(data.append!=undefined)
{$(data.append).html(data.html);}
if(data.script!=undefined)
{$.globalEval(data.script);}}},complete:function(){hideLoader();}});}
var u_pulse_error_to=null;var u_pulse_info_to=null;function pulseError(msg,opt)
{if(opt==undefined)
{opt={sticky:false};}
time=2000;if(opt.sticky)
{time=900000;}
$("#pulse-error").html(msg);$("#pulse-error").stop().fadeIn();u_pulse_error_to=setTimeout(function(){$("#pulse-error").fadeOut();$(document).unbind('click');},time);setTimeout(function(){$(document).bind('click',function(){$("#pulse-error").stop().fadeOut();$(document).unbind('click');clearTimeout(u_pulse_error_to);});},500);}
function pulseInfo(msg,opt)
{if(opt==undefined)
{opt={sticky:false};}
time=2000;if(opt.sticky)
{time=900000;}
$("#pulse-info").html(msg);$("#pulse-info").fadeIn();u_pulse_info_to=setTimeout(function(){$("#pulse-info").fadeOut();$(document).unbind('click');},time);setTimeout(function(){$(document).bind('click',function(){$("#pulse-info").fadeOut();$(document).unbind('click');clearTimeout(u_pulse_info_to);});},500);}
function addHover(sel){$(sel).hover(function(){$(this).addClass("hover");},function(){$(this).removeClass("hover");});}
function infoMenu()
{addHover("div#msgBar .bar-item");$("div#msgBar .bar-msg").click(function(event){event.stopPropagation();$("#msgbar-messages").toggle();$("#msgbar-infos").hide();$("#msgbar-basket").hide();});$("#msgbar-messages").click(function(event){event.stopPropagation();});$(document).click(function(){$("#msgbar-messages").hide();$("#msgbar-infos").hide();});$("div#msgBar .bar-info").click(function(event){event.stopPropagation();$("#msgbar-infos").toggle();$("#msgbar-messages").hide();$("#msgbar-basket").hide();});$("div#msgBar .bar-basket").click(function(event){event.stopPropagation();$("#msgbar-infos").hide();$("#msgbar-messages").hide();if($('#msgbar-basket').is(":visible"))
{$("#msgbar-basket").hide();g_interval_newBasket=setInterval(function(){ajreq("update",{app:"basket",loader:false});},10000);}
else
{clearInterval(g_interval_newBasket);if($("#msgbar-basket ul li.msg").length==0)
{$("#msgbar-basket ul").prepend('<li class="loading">&nbsp;</li>');}
ajreq("loadupdates",{app:"basket",loader:false});$("#msgbar-basket").show();}
event.stopPropagation();});$("#msgBar-badge span.bar-info").mouseover(function(){$("#msgBar .bar-info").trigger('mouseover');});$("#msgBar-badge span.bar-info").mouseout(function(){$("#msgBar .bar-info").trigger('mouseout');});$("#msgBar-badge span.bar-msg").mouseover(function(){$("#msgBar .bar-msg").trigger('mouseover');});$("#msgBar-badge span.bar-msg").mouseout(function(){$("#msgBar .bar-msg").trigger('mouseout');});$("#msgBar-badge span.bar-basket").mouseover(function(){$("#msgBar .bar-item.bar-basket").trigger('mouseover');});$("#msgBar-badge span.bar-basket").mouseout(function(){$("#msgBar .bar-item.bar-basket").trigger('mouseout');});$("#msgBar-badge span.bar-basket").click(function(){$("#msgBar .bar-item.bar-basket").trigger('click');});$("#msgBar-badge span.bar-info").click(function(event){event.stopPropagation();$("div#msgBar .bar-info").trigger('click');});$("#msgBar-badge span.bar-msg").click(function(event){event.stopPropagation();$("div#msgBar .bar-msg").trigger('click');});$('#msgBar .bar-item').on("touchstart",function(ev){$(this).addClass('hover');});$('#msgBar .bar-item').on("touchend",function(ev){$(this).removeClass('hover');});init_chat();init_infos();}
function init_infos()
{$.ajax({dataType:"json",url:"xhr.php?f=getGlocke",success:function(data){hideLoader();if(data.status==1)
{$("#msgbar-infos ul").html(data.html);if(data.count>0)
{$('#msgBar-badge .bar-info').html(data.count);$('#msgBar-badge .bar-info').css({opacity:1});}}
else if(data.status==0)
{$('#msgBar-badge .bar-info').html('0');$("#msgbar-infos ul").html(data.html);$('#msgBar-badge .bar-info').css({opacity:0});}}});}
var g_interval_newMsg=null;var g_interval_newBasket=null;function init_chat()
{g_interval_newMsg=checkNewMsg(false);ajreq('update',{app:'basket',loader:false});g_interval_newBasket=setInterval(function(){ajreq('update',{app:'basket',loader:false});},10000);}
function aNotify()
{}
function chatIsOpen()
{if($(".fancybox-opened input#xhr_sender_id").length>0)
{return true;}
else
{return false;}}
function checkEmail(email){var filter=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(!filter.test(email))
{return false;}
else
{return true;}}
function img(photo)
{if(photo.length>3)
{return'images/med_q_'+photo;}
else
{return'img/med_q_avatar.png';}}
function xhr_chat_scroll()
{setTimeout(function(){$("#xhr-chat-focus").focus();$('#msganswer').focus();},100);}
var g_firstChatUpdate=true;function updateChat()
{$.ajax({dataType:"json",url:"xhr.php?f=updateChat&fsid="+$("#xhr_sender_id").val()+'&fu='+g_firstChatUpdate,success:function(data){hideLoader();if(data.status==1)
{$("ul#xv_message").html(data.html);if(data.script!=undefined)
{$.globalEval(data.script);}
if(g_firstChatUpdate)
{$("#scrollbar1").tinyscrollbar_update('bottom');g_firstChatUpdate=false;}}
else if(data.status==0)
{}}});}
function startChat(fsid)
{xhr_chat=setInterval(function(){alert('get ');},1000);}
function stopChat()
{alert('stoppe');clearInterval(xhr_chat);}
function fancy_xhr(func,loader)
{if(loader==undefined)
{loader=true;}
if(loader)
{showLoader();}
$.ajax({dataType:"json",url:"xhr.php?f="+func,success:function(data){if(data.status==1)
{$("#fancy").html(data.html);$("#fancylink").trigger("click");if(data.script!=undefined)
{$.globalEval(data.script);}}
else
{error(data.msg);}},complete:function(){if(loader)
{hideLoader();}}});}
function fancy(content,title,subtitle)
{t='';s='';if(title!=undefined)
{t='<h3>'+title+'</h3>';}
if(subtitle!=undefined)
{s='<p class="subtitle">'+subtitle+'</p>';}
$("#fancy").html('<div class="popbox">'+t+s+content+'</div>');$("#fancylink").trigger("click");}
function isMob()
{if($(window).width()<768)
{return true;}
return false;}
function checkNewMsg(sound)
{if(sound==undefined)
{sound=true;}
mob=0;if(isMob())
{mob=1;}
$.ajax({dataType:"json",url:"xhr.php?f=getNewMsg&mob="+mob,success:function(data){if(data.status==1)
{if(data.script!=undefined)
{if(sound)
{$.globalEval(data.script);}}
$("#msgbar-messages ul").html(data.html);$("#msgBar-badge span.bar-msg").html(data.count);$("#msgBar-badge span.bar-msg").css({opacity:1});}
else if(data.status==0)
{$("#msgBar-badge span.bar-msg").css({opacity:0});$("#msgbar-messages ul").html(data.html);}
$(".ui-delbuddyreq").click(function(ev){ev.stopPropagation();});}});}
function hideBadge()
{$('#msgBar-badge').hide();}
function showBadge()
{$('#msgBar-badge').show();}
function xhrf(func)
{showLoader();$.ajax({dataType:"json",url:"xhr.php?f="+func,success:function(data){hideLoader();if(data.status==1)
{hideLoader();}},complete:function(){hideLoader();}});}
function reload()
{location.reload();}
function v_field(content,title,id)
{return'<div id="'+id+'"><div class="head ui-widget-header ui-corner-top">'+title+'</div><div class="ui-widget ui-widget-content ui-corner-bottom margin-bottom ui-padding">'+content+'</div></div>';}
function v_hidden(name,val)
{return'<input type="hidden" name="'+name+'" class="'+name+'" value="'+val+'" />';}
function hiddenDialog(id,table,title)
{$("#"+id).dialog({autoOpen:false,modal:true,title:title,buttons:{"Speichern":function()
{showLoader();$.ajax({dataType:"json",url:"xhr.php?f=update_"+table+"&"+$('#'+id+' form').serialize(),success:function(data){$("#"+id).dialog('close');if(data.script!=undefined)
{$.globalEval(data.script);}},complete:function(){hideLoader();}});}}});}
function openPhotoDialog(fs_id)
{$("#uploadPhoto-fs_id").val(fs_id);$("#uploadPhoto").dialog('open');}
function sendMail(fs_id)
{$('#sendmail-fs-id').val(fs_id);$("#sendMail").dialog("open");}
function info(txt)
{if($('#info-msg').length==0)
{$('#top').after('<div class="ui-widget ui-msg"><div class="ui-state-highlight ui-corner-all ui-padding"><span style="float: left; margin-right: .3em;" class="ui-icon ui-icon-info"></span><ul id="info-msg">'+txt+'</ul><div class="clear"></div></div></div>');}
else
{$('#info-msg').append('<li>'+txt+'</li>');}}
function error(txt)
{pulseError(txt);}
function uploadPhoto()
{$('#uploadPhoto form').submit();}
function uploadPhotoReady(id,file)
{fs_id=$('#uploadPhoto-fs_id').val();$("#miniq-"+id).attr('src',file);$("#uploadPhoto").dialog('close');info('Foto erfolgreich hochgeladen!');}
function addSelect(id)
{if($("#"+id+"neu").val().length>0)
{$.ajax({dataType:"json",url:"xhr.php?f=add"+ucfirst(id)+"&neu="+encodeURIComponent($("#"+id+"neu").val()),success:function(data){$("#"+id).append('<option value="'+data.id+'">'+data.name+'</option>');$("#"+id+"neu").val("");$("#"+id+"-dialog").dialog("close");$("#"+id+" option").removeAttr("selected");$("#"+id+" option").last().attr("selected",true);}});}}
function betrieb(id)
{goTo('?page=betrieb&id='+id);}
function goTo(url)
{if(url!='#')
{document.location.href=url;}}
function ucfirst(str){str+='';var f=str.charAt(0).toUpperCase();return f+str.substr(1);}
function accordionNext(id,max)
{current=$('#'+id).accordion("option","active");if(current<max)
{$('#'+id).accordion("option","active",(current+1));}}
function showComment(id)
{$("#dialog-comment").html($("#comment-"+id).val());$("#dialog-comment").dialog('option','title',$("#comment-title-"+id).val());$("#dialog-comment").dialog('open');}
function ajaxconfirm(url,question,title)
{if(question!=undefined)
{$('#dialog-confirm-msg').html(question);}
if(title!=undefined)
{$('#dialog-confirm').dialog('option','title',title);}
$('#dialog-confirm-url').val(url);$('#dialog-confirm').dialog('open');}
function ifconfirm(url,question,title)
{if(question!=undefined)
{$('#dialog-confirm-msg').html(question);}
if(title!=undefined)
{$('#dialog-confirm').dialog('option','title',title);}
$('#dialog-confirm-url').val(url);$('#dialog-confirm').dialog('open');}
function picFinish(img,id)
{$('#'+id+'-action').val('upload');$.fancybox.close();d=new Date();imgp=img+'?'+d.getTime();$('#'+id+'-open').html('<img src="images/'+imgp+'" /><input type="hidden" name="photo" value="'+img+'" />');hideLoader();reload();}
function pic_error(msg,id)
{msg='<div class="ui-widget"><div style="padding: 15px;" class="ui-state-error ui-corner-all"><p><span style="float: left; margin-right: .3em;" class="ui-icon ui-icon-alert"></span><strong>Fehler:</strong> '+msg+'</p></div></div>';$('#'+id+'-placeholder').html(msg);hideLoader();}
function fotoupload(file,id)
{$('#'+id+'-file').val(file);d=new Date();img=file+'?'+d.getTime();$('#'+id+'-placeholder').html('<img src="./tmp/'+img+'" />');jcrop=$('#'+id+'-placeholder img').Jcrop({setSelect:[100,0,400,400],aspectRatio:35/45,onSelect:function(c){$('#'+id+'-x').val(c.x);$('#'+id+'-y').val(c.y);$('#'+id+'-w').val(c.w);$('#'+id+'-h').val(c.h);}});$('#'+id+'-save').show();$('#'+id+'-save').button().click(function(){showLoader();$('#'+id+'-action').val('crop');$('#'+id+'-form')[0].submit();return false;});$('#'+id+'-placeholder').css('height','auto');hideLoader();setTimeout(function(){$.fancybox.update();$.fancybox.reposition();$.fancybox.toggle();},200);}
function closeBox()
{$.fancybox.close();}
function pictureReady(id,img)
{$('#'+id+'-preview').html('<img src="images/'+id+'/thumb_'+img+'" />');$('#'+id).val(id+'/'+img);$.fancybox.close();hideLoader();}
function pictureCrop(id,img)
{ratio=$.parseJSON($('#'+id+'-ratio').val());ratio_val=$.parseJSON($('#'+id+'-ratio-val').val());ratio_i=parseInt($('#'+id+'-ratio-i').val());if(ratio[ratio_i]!=undefined)
{$('#'+id+'-ratio-i').val((ratio_i+1));if($('#'+id+'-ratio'))
{}
$('#'+id+'-crop').html('<img src="images/'+id+'/'+img+'" /><br /><span id="'+id+'-crop-save">Speichern</span>');$('#'+id+'-crop img').Jcrop({setSelect:[100,0,400,400],aspectRatio:ratio[ratio_i],onSelect:function(c){$('#'+id+'-x').val(c.x);$('#'+id+'-y').val(c.y);$('#'+id+'-w').val(c.w);$('#'+id+'-h').val(c.h);}});hideLoader();setTimeout(function(){$.fancybox.update();$.fancybox.reposition();$.fancybox.toggle();},200);$('#'+id+'-crop-save').button().click(function(){ratio_val[ratio_val.length]={x:Math.round($('#'+id+'-x').val()),y:Math.round($('#'+id+'-y').val()),w:Math.round($('#'+id+'-w').val()),h:Math.round($('#'+id+'-h').val())}
$('#'+id+'-ratio-val').val(JSON.stringify(ratio_val));pictureCrop(id,img);});}
else
{showLoader();$('#'+id+'-form').attr('action','xhr.php?f=pictureCrop&id='+id+'&img='+img);$('#'+id+'-form').submit();}}
function nl2br(str,is_xhtml){var breakTag=(is_xhtml||typeof is_xhtml==='undefined')?'<br '+'/>':'<br>';return(str+'').replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,'$1'+breakTag+'$2');}
function checkOnline(saver)
{$.ajax({dataType:"json",url:"xhr.php?f=checkOnline",data:"saver="+saver,success:function(data){if(data.status==1)
{for(i=0;i<data.saver.length;i++)
{$(".saver-ampel-"+data.saver[i].id).removeClass("ampel-grau ampel-gruen");if(data.saver[i].online)
{$(".saver-ampel-"+data.saver[i].id).addClass("ampel-gruen");if($(".saver-ampel-"+data.saver[i].id).length>0&&$(".saver-ampel-"+data.saver[i].id).prev().attr('title')!=undefined)
{$(".saver-ampel-"+data.saver[i].id).prev().attr('title',$(".saver-ampel-"+data.saver[i].id).prev().attr('title').replace('offline','online'));}}
else if($(".saver-ampel-"+data.saver[i].id).length>0)
{$(".saver-ampel-"+data.saver[i].id).addClass("ampel-grau");$(".saver-ampel-"+data.saver[i].id).prev().attr('title',$(".saver-ampel-"+data.saver[i].id).prev().attr('title').replace('online','offline'));}
$(".saver-ampel-"+data.saver[i].id).prev().tooltip();}}}});}
function u_loadCoords(addressdata,func)
{anschrift="";if(addressdata.str!=undefined)
{anschrift=addressdata.str+' '+addressdata.hsnr;}
else
{tmp=addressdata.anschrift.split("/");anschrift=tmp[0];}
address=encodeURIComponent(anschrift+', '+addressdata.plz+', '+addressdata.stadt+', Deutschland');url="http://maps.google.com/maps/api/geocode/json?address="+address+"&sensor=false&region=DE&language=de";showLoader();$(document).ready(function(){$.getJSON(url,function(data){if(data.status=='OK')
{for(i=0;i<data.results.length;i++)
{check=false;for(y=0;y<data.results[i].address_components.length;y++)
{if(data.results[i].address_components[y].long_name==addressdata.plz)
{check=true;}}
if(check)
{$("#pulse-error").hide();hideLoader();func(data.results[i].geometry.location.lat,data.results[i].geometry.location.lng);return true;break;}}}
hideLoader();pulseError("<strong>Die Koordinaten konnten nicht berechnet werden</strong><br />sind alle Eingaben Richtig? Ohne Koordinaten wird die Adresse nicht auf der Karte zu sehen sein");});});}
function showLoader()
{$.fancybox.showLoading();}
function hideLoader()
{$.fancybox.hideLoading();}
function betriebRequest(id)
{showLoader();$.ajax({url:"xhr.php?f=betriebRequest",data:{"id":id},dataType:"json",success:function(data){if(data.status==1)
{pulseInfo(data.msg);}},complete:function(){hideLoader();}});}
function checkAllCb(sel)
{$("input[type=\'checkbox\']").prop("checked",sel);}
function becomeBezirk()
{$("#becomeBezirk-link").fancybox({minWidth:390,maxWidth:400});$("#becomeBezirk-link").trigger('click');}
jQuery.fn.extend({disableSelection:function(){return this.each(function(){this.onselectstart=function(){return false;};this.unselectable="on";jQuery(this).css('user-select','none');jQuery(this).css('-o-user-select','none');jQuery(this).css('-moz-user-select','none');jQuery(this).css('-khtml-user-select','none');jQuery(this).css('-webkit-user-select','none');});return this;}});
var windowFocus=true;var username;var chatHeartbeatCount=0;var minChatHeartbeat=1000;var maxChatHeartbeat=33000;var chatHeartbeatTime=minChatHeartbeat;var originalTitle;var blinkOrder=0;var g_chatheartbeatTO=null;var chatboxFocus=new Array();var newMessages=new Array();var newMessagesWin=new Array();var chatBoxes=new Array();var chatBlinkInterval=new Array();$(document).ready(function(){originalTitle=document.title;startChatSession();$([window,document]).blur(function(){windowFocus=false;}).focus(function(){windowFocus=true;document.title=originalTitle;});});function restructureChatBoxes(){align=0;for(x in chatBoxes){chatboxtitle=chatBoxes[x];if($("#chatbox_"+chatboxtitle).css('display')!='none')
{if(align==0)
{$("#chatbox_"+chatboxtitle).css('right','20px');}
else
{width=(align)*(273+7)+20;$("#chatbox_"+chatboxtitle).css('right',width+'px');}
align++;}}}
function chatWith(id){$('.ui-dialog-content').each(function(){$this=$(this);if($this.parent().hasClass('ui-dialog'))
{$this.dialog({autoOpen:false});$this.dialog('close');}});if($("#chatbox_"+id).length>0){if($("#chatbox_"+id).css('display')=='none'){$("#chatbox_"+id).css('display','block');restructureChatBoxes();}
$("#chatbox_"+id+' .chatboxcontent').css('display','block');$("#chatbox_"+id+' .chatboxinput').css('display','block');$("#chatbox_"+id+" .chatboxtextarea").focus();}
else
{var id=id;$.ajax({url:'xhrapp.php?app=chat&m=init&id='+id,dataType:'json',success:function(data){createChatBox(data);if(data.msg!=false)
{var last_time='';for(i=0;i<data.msg.length;i++)
{chatAddMsg(id,data.msg[i],false);last_time=data.msg[i].t;}
if(last_time!='')
{chatAppendTime(id,last_time);$("#chatbox_"+id+" .chatboxcontent").scrollTop($("#chatbox_"+id+" .chatboxcontent")[0].scrollHeight);}}
$("#chatbox_"+id+" .chatboxtextarea").focus();}});}
$("#msgbar-messages").hide();$("#msgbar-infos").hide();}
function killBr(str)
{str=str.replace('\r','');for(i=0;i<40;i++)
{str=str.replace('\n\n\n','\n\n');}
return str;}
function chatnl2br(str,is_xhtml){str=killBr(str).autoLink({target:'_blank'});var breakTag=(is_xhtml||typeof is_xhtml==='undefined')?'<br />':'<br>';return(str+'').replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,'$1'+breakTag+'$2');}
function createChatBox(user,minimizeChatBox){if($("#chatbox_"+user.f).length>0){if($("#chatbox_"+user.f).css('display')=='none'){$("#chatbox_"+user.f).css('display','block');restructureChatBoxes();}
$("#chatbox_"+user.f+" .chatboxtextarea").focus();return;}
chatboxtitle=user.f;chatHiddenImg(user.f,user.p);var $div=$('<div />').appendTo('body');$div.attr("id","chatbox_"+user.f);$div.addClass("chatbox");$div.addClass("ui-corner-top");$div.html('<div class="chatboxhead ui-corner-top"><a class="chatboxtitle" href="javascript:void(0)" onclick="javascript:toggleChatBoxGrowth(\''+user.f+'\')">'+user.n+'</a><div class="chatboxoptions"><a href="javascript:void(0)" onclick="javascript:closeChatBox(\''+user.f+'\')">X</a></div><br clear="all"/></div><div class="chatboxcontent"></div><div class="chatboxinput"><textarea class="chatboxtextarea" onkeydown="javascript:return checkChatBoxInputKey(event,this,\''+user.f+'\');"></textarea></div>');$("#chatbox_"+user.f).css('bottom','0px');chatBoxeslength=0;for(x in chatBoxes){if($("#chatbox_"+chatBoxes[x]).css('display')!='none'){chatBoxeslength++;}}
if(chatBoxeslength==0){$("#chatbox_"+user.f).css('right','20px');}else{width=(chatBoxeslength)*(273+7)+20;$("#chatbox_"+user.f).css('right',width+'px');}
chatBoxes.push(user.f);if(minimizeChatBox==1){minimizedChatBoxes=new Array();if($.cookie('chatbox_minimized')){minimizedChatBoxes=$.cookie('chatbox_minimized').split(/\|/);}
minimize=0;for(j=0;j<minimizedChatBoxes.length;j++){if(minimizedChatBoxes[j]==chatboxtitle){minimize=1;}}
if(minimize==1){$('#chatbox_'+chatboxtitle+' .chatboxcontent').css('display','none');$('#chatbox_'+chatboxtitle+' .chatboxinput').css('display','none');}}
chatboxFocus[chatboxtitle]=false;$("#chatbox_"+chatboxtitle+" .chatboxtextarea").blur(function(){chatboxFocus[chatboxtitle]=false;$("#chatbox_"+chatboxtitle+" .chatboxtextarea").removeClass('chatboxtextareaselected');}).focus(function(){chatboxFocus[chatboxtitle]=true;newMessages[chatboxtitle]=false;$('#chatbox_'+chatboxtitle+' .chatboxhead').removeClass('chatboxblink');if(chatBlinkInterval[chatboxtitle]!=undefined)
{clearInterval(chatBlinkInterval[chatboxtitle]);}
else if(chatBlinkInterval[chatboxtitle]!=false)
{clearInterval(chatBlinkInterval[chatboxtitle]);}
chatBlinkInterval[chatboxtitle]=false;});$("#chatbox_"+chatboxtitle).click(function(){if($('#chatbox_'+chatboxtitle+' .chatboxcontent').css('display')!='none'){}});$("#chatbox_"+chatboxtitle).show();$('.chatboxtextarea').focus(function(){$('.chatboxtextarea').removeClass('chatboxtextareaselected');$(this).addClass('chatboxtextareaselected');});$('.chatboxtextarea').keydown(function(objEvent){if(objEvent.keyCode==9){objEvent.preventDefault();}});}
function chatHeartbeat(){var itemsfound=0;if(windowFocus==false){var blinkNumber=0;var titleChanged=0;for(x in newMessagesWin){if(newMessagesWin[x]==true){++blinkNumber;if(blinkNumber>=blinkOrder){document.title='Neue Nachricht...';titleChanged=1;break;}}}
if(titleChanged==0){document.title=originalTitle;blinkOrder=0;}else{++blinkOrder;}}else{for(x in newMessagesWin){newMessagesWin[x]=false;}}
for(x in newMessages){if(newMessages[x]==true){if(chatboxFocus[x]==false){if(chatBlinkInterval[x]==undefined||chatBlinkInterval[x]==false)
{chatBlinkInterval[x]=setInterval(function(){$('#chatbox_'+x+' .chatboxhead').toggleClass('chatboxblink');},1000);}}}}
$.ajax({url:"chat.php?action=chatheartbeat",cache:false,dataType:"json",success:function(data){$.each(data.items,function(i,item){if(item){chatAddMsg(item.f,item);itemsfound+=1;last_time=item.t;}});chatHeartbeatCount++;if(itemsfound>0){chatHeartbeatTime=minChatHeartbeat;chatHeartbeatCount=1;}else if(chatHeartbeatCount>=10){chatHeartbeatTime*=2;chatHeartbeatCount=1;if(chatHeartbeatTime>maxChatHeartbeat){chatHeartbeatTime=maxChatHeartbeat;}}
g_chatheartbeatTO=setTimeout('chatHeartbeat();',chatHeartbeatTime);}});}
function chatAddMsg(id,item,newmsg)
{if(newmsg==undefined)
{newmsg=true;}
chatboxtitle=id;name=item.n;if($("#chatbox_"+chatboxtitle).length<=0){createChatBox(item);}
if($("#chatbox_"+chatboxtitle).css('display')=='none'){$("#chatbox_"+chatboxtitle).css('display','block');restructureChatBoxes();}
if(item.s==1){item.f=username;}
if(item.s==2){chatAppendTime(id,item.m);}else{if(newmsg)
{newMessages[chatboxtitle]=true;newMessagesWin[chatboxtitle]=true;}
$("#chatbox_"+chatboxtitle+" .chatboxcontent").append('<div class="chatboxmessage" title="'+item.sent+'"><span class="chatboxmessagefrom">'+chatImg(item.f)+'</span><span class="chatboxmessagecontent">'+nl2br(item.m)+'</span><div style="clear:both;"></div></div>');}
if($("#chatbox_"+chatboxtitle+" .chatboxcontent").length>0)
{$("#chatbox_"+chatboxtitle+" .chatboxcontent").scrollTop($("#chatbox_"+chatboxtitle+" .chatboxcontent")[0].scrollHeight);}}
function chatAppendTime(id,time)
{if(time!=undefined)
{$("#chatbox_"+id+" .chatboxcontent").append('<div class="chatboxmessage"><span class="chatboxinfo" title="'+time+'">'+time+'</span></div>');$('.chatboxinfo').timeago();}}
function closeChatBox(chatboxtitle){$('#chatbox_'+chatboxtitle).css('display','none');restructureChatBoxes();$.post("chat.php?action=closechat",{chatbox:chatboxtitle},function(data){});}
function toggleChatBoxGrowth(chatboxtitle){if($('#chatbox_'+chatboxtitle+' .chatboxcontent').css('display')=='none'){var minimizedChatBoxes=new Array();if($.cookie('chatbox_minimized')){minimizedChatBoxes=$.cookie('chatbox_minimized').split(/\|/);}
var newCookie='';for(i=0;i<minimizedChatBoxes.length;i++){if(minimizedChatBoxes[i]!=chatboxtitle){newCookie+=chatboxtitle+'|';}}
newCookie=newCookie.slice(0,-1)
$.cookie('chatbox_minimized',newCookie);$('#chatbox_'+chatboxtitle+' .chatboxcontent').css('display','block');$('#chatbox_'+chatboxtitle+' .chatboxinput').css('display','block');$("#chatbox_"+chatboxtitle+" .chatboxcontent").scrollTop($("#chatbox_"+chatboxtitle+" .chatboxcontent")[0].scrollHeight);}else{var newCookie=chatboxtitle;if($.cookie('chatbox_minimized')){newCookie+='|'+$.cookie('chatbox_minimized');}
$.cookie('chatbox_minimized',newCookie);$('#chatbox_'+chatboxtitle+' .chatboxcontent').css('display','none');$('#chatbox_'+chatboxtitle+' .chatboxinput').css('display','none');}}
function checkChatBoxInputKey(event,chatboxtextarea,chatboxtitle){if(event.keyCode==13&&event.shiftKey==0){message=$(chatboxtextarea).val();message=message.replace(/^\s+|\s+$/g,"");killBr(message);$(chatboxtextarea).val('');$(chatboxtextarea).css('height','44px');if(message!=''){$.ajax({url:"xhrapp.php?app=chat&m=sendchat",data:{to:chatboxtitle,message:message},type:'post',dataType:'json',success:function(data){message=message.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;");$("#chatbox_"+chatboxtitle+" .chatboxcontent").append('<div class="chatboxmessage"><span class="chatboxmessagefrom">'+chatImg(username)+'</span><span class="chatboxmessagecontent">'+chatnl2br(message)+'</span><div style="clear:both;"></div></div>');$("#chatbox_"+chatboxtitle+" .chatboxcontent").scrollTop($("#chatbox_"+chatboxtitle+" .chatboxcontent")[0].scrollHeight);}});}
chatHeartbeatTime=minChatHeartbeat;chatHeartbeatCount=1;return false;}
var adjustedHeight=chatboxtextarea.clientHeight;var maxHeight=94;if(maxHeight>adjustedHeight){adjustedHeight=Math.max(chatboxtextarea.scrollHeight,adjustedHeight);if(maxHeight)
adjustedHeight=Math.min(maxHeight,adjustedHeight);if(adjustedHeight>chatboxtextarea.clientHeight)
$(chatboxtextarea).css('height',adjustedHeight+8+'px');}else{$(chatboxtextarea).css('overflow','auto');}}
function chatHiddenImg(id,photo)
{if(photo!=undefined&&photo!='')
{$('#chatHidden .hImg-'+id).remove();photo='<a onclick="profile('+parseInt(id)+');return false;" class="photo" href="#'+id+'"><img src="images/mini_q_'+photo+'" /></a>';$('#chatHidden').append('<div class="hImg-'+id+'">'+photo+'</div>');}}
function startChatSession(){$('body:last').append('<div id="chatHidden" style="display:none;"></div>');$.ajax({url:"chat.php?action=startchatsession",cache:false,dataType:"json",success:function(data){username=data.username;chat_photo=data.photo;chatHiddenImg(username,data.photo);$.each(data.items,function(i,item){if(item){chatboxtitle=item.f;if($("#chatbox_"+chatboxtitle).length<=0){createChatBox(item,1);}
if(item.s==1){item.f=username;}
if(item.s==2){$("#chatbox_"+chatboxtitle+" .chatboxcontent").append('<div class="chatboxmessage"><span class="chatboxinfo" title="'+item.m+'">'+item.m+'</span></div>');$('.chatboxinfo').timeago();}else{$("#chatbox_"+chatboxtitle+" .chatboxcontent").append('<div class="chatboxmessage"><span class="chatboxmessagefrom">'+chatImg(item.f)+'</span><span class="chatboxmessagecontent">'+chatnl2br(item.m)+'</span><div style="clear:both;"></div></div>');}}});for(i=0;i<chatBoxes.length;i++){chatboxtitle=chatBoxes[i];$("#chatbox_"+chatboxtitle+" .chatboxcontent").scrollTop($("#chatbox_"+chatboxtitle+" .chatboxcontent")[0].scrollHeight);setTimeout('$("#chatbox_"+chatboxtitle+" .chatboxcontent").scrollTop($("#chatbox_"+chatboxtitle+" .chatboxcontent")[0].scrollHeight);',100);}
setTimeout('chatHeartbeat();',chatHeartbeatTime);}});}
function chatImg(id)
{if($('#chatHidden .hImg-'+id).length>0)
{return $('#chatHidden .hImg-'+id).html();}
else
{return'';}}
jQuery.cookie=function(name,value,options){if(typeof value!='undefined'){options=options||{};if(value===null){value='';options.expires=-1;}
var expires='';if(options.expires&&(typeof options.expires=='number'||options.expires.toUTCString)){var date;if(typeof options.expires=='number'){date=new Date();date.setTime(date.getTime()+(options.expires*24*60*60*1000));}else{date=options.expires;}
expires='; expires='+date.toUTCString();}
var path=options.path?'; path='+(options.path):'';var domain=options.domain?'; domain='+(options.domain):'';var secure=options.secure?'; secure':'';document.cookie=[name,'=',encodeURIComponent(value),expires,path,domain,secure].join('');}else{var cookieValue=null;if(document.cookie&&document.cookie!=''){var cookies=document.cookie.split(';');for(var i=0;i<cookies.length;i++){var cookie=jQuery.trim(cookies[i]);if(cookie.substring(0,name.length+1)==(name+'=')){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break;}}}
return cookieValue;}};
