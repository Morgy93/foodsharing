#!/bin/bash
# run docker-compose with the container specified by $FS_ENV and a suitable project name
# which command to run by docker-compose and additional arguments is specified by the arguments
# of this script

set -o errexit

dir=$(dirname "$0")

# Export the current host operating system to FS_PLATFORM
unameOut="$(uname -s)"
case "${unameOut}" in
    Darwin*)    export FS_PLATFORM=mac;;
    *)          export FS_PLATFORM=default;;
esac

# check if gp is there
if [[ $(type -t gp) == file ]];
then
    FS_PLATFORM=gitpod
fi

# shellcheck source=./__helping-functions.sh
source "$dir"/__helping-functions.sh

docker-compose \
  --file "$dir"/../docker/docker-compose.yml \
  --file "$dir"/../docker/docker-compose."$FS_ENV".yml \
  --project-name foodsharing_"$FS_ENV" \
  "$@"
